(()=>{"use strict";var e,t={510:(e,t,s)=>{var a=s(848),i=s(540),r=s(338),n=s(26);const o=new class{constructor(){this.initialized=!1,this.EXTENSION_ID="veo-3-prompter",this.init()}async init(){try{if(this.isBackgroundScript()){if("undefined"==typeof ExtPay)return console.warn("ExtPay not available in background script context"),void(this.initialized=!1);this.extpay=ExtPay(this.EXTENSION_ID),this.extpay.startBackground(),this.initialized=!0,console.log("PaymentService initialized in background script")}else{const{default:e}=await s.e(121).then(s.bind(s,32));this.extpay=e(this.EXTENSION_ID),this.initialized=!0,console.log("PaymentService initialized in popup context")}}catch(e){console.error("Failed to initialize PaymentService:",e),this.initialized=!1}}isBackgroundScript(){return"undefined"!=typeof chrome&&chrome.runtime&&"function"==typeof chrome.runtime.getManifest&&!chrome.tabs}async ensureInitialized(){if(this.initialized||await this.init(),!this.extpay)throw new Error("PaymentService not properly initialized")}async getUser(){if(!this.isBackgroundScript())try{return new Promise(e=>{chrome.runtime.sendMessage({type:"GET_PAYMENT_STATUS"},t=>{chrome.runtime.lastError?(console.error("Error getting payment status from background:",chrome.runtime.lastError),e({paid:!1,installedAt:new Date})):e(t)})})}catch(e){return console.error("Error communicating with background script:",e),{paid:!1,installedAt:new Date}}await this.ensureInitialized();try{const e=await this.extpay.getUser();return{paid:e.paid||!1,paidAt:e.paidAt?new Date(e.paidAt):void 0,installedAt:new Date(e.installedAt),trialStartedAt:e.trialStartedAt?new Date(e.trialStartedAt):void 0,email:e.email,subscriptionStatus:e.subscriptionStatus}}catch(e){return console.error("Error getting user payment status:",e),{paid:!1,installedAt:new Date}}}async isPremiumUser(){const e=await this.getUser();return e.paid&&"active"===e.subscriptionStatus}async openPaymentPage(){await this.ensureInitialized();try{this.extpay.openPaymentPage()}catch(e){throw console.error("Error opening payment page:",e),new Error("Unable to open payment page")}}async getPlans(){await this.ensureInitialized();try{return(await this.extpay.getPlans()).map(e=>({id:e.id,title:e.title,description:e.description,price:e.price,currency:e.currency,interval:e.interval}))}catch(e){return console.error("Error getting payment plans:",e),[]}}onPaid(e){this.extpay?this.extpay.onPaid.addListener(t=>{const s={paid:t.paid||!1,paidAt:t.paidAt?new Date(t.paidAt):void 0,installedAt:new Date(t.installedAt),trialStartedAt:t.trialStartedAt?new Date(t.trialStartedAt):void 0,email:t.email,subscriptionStatus:t.subscriptionStatus};e(s)}):console.warn("ExtPay not initialized, payment listener not added")}async canUseFeature(e){const t=await this.isPremiumUser();return{gpt_modification:t,unlimited_saves:t,advanced_search:!0,custom_categories:t}[e]||!1}async getUsageLimits(){return await this.isPremiumUser()?{gptModifications:-1,savedPrompts:-1}:{gptModifications:3,savedPrompts:10}}async trackUsage(e){if(await this.isPremiumUser())return!0;const t=`usage_${e}_${(new Date).toDateString()}`;try{const s=(await chrome.storage.local.get([t]))[t]||0,a=await this.getUsageLimits();let i;return i="gpt_modification"===e?a.gptModifications:a.savedPrompts,!(s>=i)&&(await chrome.storage.local.set({[t]:s+1}),!0)}catch(e){return console.error("Error tracking usage:",e),!1}}async getRemainingUsage(e){if(await this.isPremiumUser())return-1;const t=`usage_${e}_${(new Date).toDateString()}`;try{const s=(await chrome.storage.local.get([t]))[t]||0,a=await this.getUsageLimits();let i;return i="gpt_modification"===e?a.gptModifications:a.savedPrompts,Math.max(0,i-s)}catch(e){return console.error("Error getting remaining usage:",e),0}}};var c=s(223);const l={apiKey:"AIzaSyCDsAJx-JUCuKC1-YR16N7APYpTh--SSLo",authDomain:"videoprompter-d6a18.firebaseapp.com",projectId:"videoprompter-d6a18",storageBucket:"videoprompter-d6a18.firebasestorage.app",messagingSenderId:"43646976330",appId:"1:43646976330:web:6d57b38a3f6c98d4c2c1b3"},d=new class{constructor(){this.db=null,this.prompts=[],this.categories=[],this.unsubscribe=null,this.initialized=!1}get database(){return this.db}getApps(){return(0,c.Dk)()}async initialize(){if(!this.initialized)try{console.log("ğŸ”§ Initializing Firebase..."),console.log("ğŸ”§ Firebase config:",l);const e=(0,c.Dk)();console.log("ğŸ”§ Existing Firebase apps:",e.length);const t=0===e.length?(0,c.Wp)(l):e[0];console.log("ğŸ”§ Firebase app initialized:",t.name),this.db=(0,n.aU)(t);try{console.log("ğŸ”§ Firebase persistence is enabled by default")}catch(e){console.warn("Firebase persistence configuration warning:",e)}return this.initialized=!0,!0}catch(e){return console.error("Firebase initialization failed:",e),!1}}subscribeToPrompts(e){if(console.log("ğŸ“¡ Subscribing to Firebase prompts..."),!this.db)return console.error("âŒ Firebase DB not initialized"),e([]),()=>{};const t=(0,n.rJ)(this.db,"prompts");console.log("ğŸ“‚ Listening to prompts collection...");try{const s=(0,n.P)(t,(0,n.My)("category")),a=(0,n.aQ)(s,t=>{const s=(new Date).toLocaleTimeString();console.log(`ğŸ“¸ [${s}] Firebase snapshot received: ${t.size} documents, empty: ${t.empty}`);const a=[];t.forEach(e=>{const t=e.data();0===a.length&&console.log(`ğŸ“„ First document ${e.id}:`,t),a.push({id:e.id,...t})}),this.prompts=a,console.log(`ğŸ”¥ [${s}] Firebase real-time update: ${a.length} prompts received`),console.log(`ğŸ“¢ [${s}] Calling callback with ${a.length} prompts`),e(a),a.length>0&&chrome.storage.local.set({cachedPrompts:a,lastSync:Date.now()})},t=>{console.error("âŒ Firebase subscription error:",t),console.error("Error details:",t.code,t.message),this.loadCachedPrompts(e)});return this.unsubscribe=a,a}catch(t){return console.error("âŒ Failed to create Firebase query:",t),e([]),()=>{}}}async loadCachedPrompts(e){const t=await chrome.storage.local.get(["cachedPrompts"]);t.cachedPrompts&&(this.prompts=t.cachedPrompts,e(t.cachedPrompts))}async getCategories(){if(!this.db)return[];try{const e=(0,n.rJ)(this.db,"categories"),t=(0,n.P)(e,(0,n.My)("order")),s=await(0,n.GG)(t),a=[];return s.forEach(e=>{a.push({id:e.id,...e.data()})}),a}catch(e){return console.error("Failed to load categories:",e),[{id:"ads",name:"Ads",icon:"ğŸ“º",description:"Commercial & promotional content"},{id:"storytelling",name:"Storytelling",icon:"ğŸ“–",description:"Narrative & cinematic content"},{id:"tutorial",name:"Tutorial",icon:"ğŸ“",description:"Educational & how-to content"},{id:"vlogging",name:"Vlogging",icon:"ğŸ¥",description:"Personal & lifestyle content"},{id:"street-interview",name:"Street Interview",icon:"ğŸ¤",description:"Urban documentary style"},{id:"tech-influencer",name:"Tech Influencer",icon:"ğŸ’»",description:"Tech reviews & announcements"},{id:"mobile-game",name:"Mobile Game",icon:"ğŸ®",description:"Game advertisements"}]}}unsubscribeFromPrompts(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}async isFirebaseEnabled(){return"YOUR_API_KEY"!==l.apiKey&&"YOUR_PROJECT_ID"!==l.projectId}},m=d,u=new class{constructor(){this.db=null,this.syncInProgress=!1}async ensureFirebaseInitialized(){this.db||(await m.initialize(),this.db=m.database)}async syncUserSubscription(e){if(!this.syncInProgress)try{this.syncInProgress=!0,console.log("ğŸ”„ Syncing subscription for user:",e),await this.ensureFirebaseInitialized();const t=await o.getUser(),s=await chrome.storage.local.get(["user"]),a=s.user?.email;if(!a)return void console.log("ğŸ“­ No user email found, skipping subscription sync (user not signed in)");const i={userId:e,email:a,subscriptionStatus:t.paid?t.subscriptionStatus||"active":"free",plan:t.paid?"pro":"free",paid:t.paid,paidAt:t.paidAt,installedAt:t.installedAt,trialStartedAt:t.trialStartedAt,lastSync:new Date,extPayData:t,createdAt:new Date,updatedAt:new Date},r=(0,n.H9)(this.db,"subscriptions",e),c=await(0,n.x7)(r);if(c.exists()){const e=c.data();i.createdAt=e.createdAt,i.updatedAt=new Date}await(0,n.BN)(r,{...i,updatedAt:(0,n.O5)()},{merge:!0}),console.log("âœ… Subscription synced successfully:",{userId:e,email:a,plan:i.plan,paid:i.paid})}catch(e){console.error("âŒ Failed to sync subscription:",e)}finally{this.syncInProgress=!1}}async getSubscription(e){try{await this.ensureFirebaseInitialized();const t=(0,n.H9)(this.db,"subscriptions",e),s=await(0,n.x7)(t);return s.exists()?s.data():null}catch(e){return console.error("âŒ Failed to get subscription:",e),null}}async getAllSubscriptions(){try{await this.ensureFirebaseInitialized();const e=(0,n.rJ)(this.db,"subscriptions"),t=await(0,n.GG)(e),s=[];return t.forEach(e=>{s.push({...e.data(),userId:e.id})}),s.sort((e,t)=>new Date(t.updatedAt).getTime()-new Date(e.updatedAt).getTime())}catch(e){return console.error("âŒ Failed to get all subscriptions:",e),[]}}async getActiveSubscribersCount(){try{await this.ensureFirebaseInitialized();const e=(0,n.rJ)(this.db,"subscriptions"),t=(0,n.P)(e,(0,n._M)("paid","==",!0),(0,n._M)("subscriptionStatus","==","active"));return(await(0,n.GG)(t)).size}catch(e){return console.error("âŒ Failed to get active subscribers count:",e),0}}async setupAutoSync(e){o.onPaid(()=>{console.log("ğŸ’° Payment detected, syncing subscription..."),this.syncUserSubscription(e)}),await this.syncUserSubscription(e),setInterval(()=>{this.syncUserSubscription(e)},3e5)}},p=new class{constructor(){this.userState={isSignedIn:!1,tier:"anonymous",dailyModificationsUsed:0,lastResetDate:(new Date).toISOString().split("T")[0]},this.DAILY_FREE_MODIFICATIONS=3,this.listeners=new Set,this.loadUserState(),chrome.storage.onChanged.addListener((e,t)=>{"local"===t&&(e.user||e.apiKey)&&this.loadUserState()}),chrome.runtime.onMessage.addListener((e,t,s)=>{"USAGE_UPDATED"===e.type&&(this.userState.dailyModificationsUsed=e.dailyUsage.count,this.userState.lastResetDate=e.dailyUsage.date,this.notifyListeners())}),chrome.runtime.onMessage.addListener((e,t,s)=>{"PAYMENT_STATUS_CHANGED"===e.type&&(console.log("ğŸ‰ Payment status changed broadcast received!"),this.loadUserState())}),setInterval(()=>{this.syncExtPayStatus()},3e4)}isAdminUser(e){return["nemanja@leaded.pro"].includes(e||"")}async loadUserState(){try{const e=await chrome.storage.local.get(["user","dailyUsage","subscription"]);if(e.user&&e.user.email&&(this.userState.isSignedIn=!0,this.userState.email=e.user.email,this.userState.userId=e.user.email,this.isAdminUser(e.user.email)?this.userState.tier="paid":this.userState.tier="free"),e.dailyUsage){const t=(new Date).toISOString().split("T")[0];e.dailyUsage.date!==t?(this.userState.dailyModificationsUsed=0,this.userState.lastResetDate=t,await this.saveDailyUsage()):(this.userState.dailyModificationsUsed=e.dailyUsage.count||0,this.userState.lastResetDate=e.dailyUsage.date)}if(!this.isAdminUser(this.userState.email)&&e.subscription&&"active"===e.subscription.status)this.userState.tier="paid",this.userState.subscription=e.subscription;else if(this.userState.isSignedIn&&!this.isAdminUser(this.userState.email))try{const e=await new Promise(e=>{chrome.runtime.sendMessage({type:"GET_PAYMENT_STATUS"},t=>{e(t||{paid:!1})})});e.paid&&(console.log("ğŸ‰ ExtPay payment detected! Activating Pro features..."),this.userState.tier="paid",this.userState.subscription={status:"active",plan:"pro",expiresAt:e.paidAt?new Date(new Date(e.paidAt).getTime()+31536e6).toISOString():new Date(Date.now()+31536e6).toISOString()},await chrome.storage.local.set({subscription:this.userState.subscription}),console.log("âœ… Pro features activated automatically!"))}catch(e){console.error("Failed to check ExtPay payment status:",e)}this.notifyListeners()}catch(e){console.error("Failed to load user state:",e)}}async saveDailyUsage(){await chrome.storage.local.set({dailyUsage:{date:this.userState.lastResetDate,count:this.userState.dailyModificationsUsed}})}getUserState(){return{...this.userState}}getFeatureAccess(){switch(this.userState.tier){case"anonymous":default:return{viewPrompts:!0,copyPrompts:!0,savePrompts:!1,modifyPrompts:!1,createPrompts:!1,createSequences:!1,unlimitedUsage:!1};case"free":return{viewPrompts:!0,copyPrompts:!0,savePrompts:!0,modifyPrompts:!0,createPrompts:!0,createSequences:!0,unlimitedUsage:!1};case"paid":return{viewPrompts:!0,copyPrompts:!0,savePrompts:!0,modifyPrompts:!0,createPrompts:!0,createSequences:!0,unlimitedUsage:!0}}}canAccess(e){return this.getFeatureAccess()[e]}getUpgradeMessage(e){return this.userState.isSignedIn?{modifyPrompts:"Upgrade to Pro to increase your daily modification limit",createPrompts:"Upgrade to Pro to increase your daily creation limit",createSequences:"Upgrade to Pro to access advanced sequence features",unlimitedUsage:"Upgrade to Pro for unlimited usage"}[e]||"Upgrade to access this feature":"savePrompts"===e?"Sign up to save your favorite prompts":"Sign up for free to unlock this feature"}async signInWithGoogle(){return new Promise((e,t)=>{chrome.runtime.sendMessage({type:"GOOGLE_SIGN_IN"},async s=>{if(chrome.runtime.lastError)t(new Error(chrome.runtime.lastError.message||"Sign in failed"));else if(s&&s.success)try{this.userState={isSignedIn:!0,tier:this.isAdminUser(s.user.email)?"paid":"free",email:s.user.email,userId:s.user.email,hasApiKey:this.userState.hasApiKey,dailyModificationsUsed:0,lastResetDate:(new Date).toISOString().split("T")[0]},await chrome.storage.local.set({user:s.user,dailyUsage:{date:this.userState.lastResetDate,count:0}}),this.userState.userId&&u.setupAutoSync(this.userState.userId).catch(e=>{console.error("Failed to setup subscription sync:",e)}),this.notifyListeners(),e()}catch(e){t(e)}else t(new Error(s?.error||"Sign in failed"))})})}async signOut(){return new Promise(e=>{chrome.runtime.sendMessage({type:"GOOGLE_SIGN_OUT"},()=>{this.userState={isSignedIn:!1,tier:"anonymous",hasApiKey:!1,dailyModificationsUsed:0,lastResetDate:(new Date).toISOString().split("T")[0]},chrome.storage.local.remove(["user","dailyUsage"],()=>{this.notifyListeners(),e()})})})}async upgradeToPaid(e){this.userState.tier="paid",this.userState.subscription={status:"active",plan:e.plan||"pro",expiresAt:e.expiresAt},await chrome.storage.local.set({subscription:this.userState.subscription}),this.notifyListeners()}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}notifyListeners(){const e=this.getUserState();this.listeners.forEach(t=>t(e))}async trackModification(){const e=(new Date).toISOString().split("T")[0];return this.userState.lastResetDate!==e&&(this.userState.dailyModificationsUsed=0,this.userState.lastResetDate=e),"paid"===this.userState.tier||!(this.userState.dailyModificationsUsed>=this.DAILY_FREE_MODIFICATIONS)&&(this.userState.dailyModificationsUsed++,await this.saveDailyUsage(),this.notifyListeners(),!0)}getRemainingModifications(){if("paid"===this.userState.tier)return-1;const e=(new Date).toISOString().split("T")[0];return this.userState.lastResetDate!==e?this.DAILY_FREE_MODIFICATIONS:Math.max(0,this.DAILY_FREE_MODIFICATIONS-this.userState.dailyModificationsUsed)}needsUpgrade(){return"free"===this.userState.tier&&this.userState.dailyModificationsUsed>=this.DAILY_FREE_MODIFICATIONS}async syncExtPayStatus(){if(this.userState.isSignedIn&&"paid"!==this.userState.tier&&!this.isAdminUser(this.userState.email))try{const e=await new Promise(e=>{chrome.runtime.sendMessage({type:"GET_PAYMENT_STATUS"},t=>{e(t||{paid:!1})})});e.paid&&"paid"!==this.userState.tier&&(console.log("ğŸ‰ New payment detected! Upgrading user to Pro..."),this.userState.tier="paid",this.userState.subscription={status:"active",plan:"pro",expiresAt:e.paidAt?new Date(new Date(e.paidAt).getTime()+31536e6).toISOString():new Date(Date.now()+31536e6).toISOString()},await chrome.storage.local.set({subscription:this.userState.subscription}),this.notifyListeners(),console.log("âœ… User automatically upgraded to Pro!"))}catch(e){console.error("Failed to sync ExtPay status:",e)}}};function h(){const[e,t]=(0,i.useState)(p.getUserState()),[s,a]=(0,i.useState)(p.getFeatureAccess()),[r,n]=(0,i.useState)(!1);return(0,i.useEffect)(()=>p.subscribe(e=>{t(e),a(p.getFeatureAccess())}),[]),{userState:e,featureAccess:s,isLoading:r,canAccess:e=>p.canAccess(e),getUpgradeMessage:e=>p.getUpgradeMessage(e),signIn:async()=>{n(!0);try{await p.signInWithGoogle()}catch(e){throw console.error("Sign in failed:",e),e}finally{n(!1)}},signOut:async()=>{n(!0);try{await p.signOut()}catch(e){throw console.error("Sign out failed:",e),e}finally{n(!1)}},trackModification:async()=>p.trackModification(),getRemainingModifications:()=>p.getRemainingModifications()}}const g=({onClose:e})=>{const{userState:t,getRemainingModifications:s,signOut:r,signIn:n}=h(),[c,l]=(0,i.useState)(!1),[d,m]=(0,i.useState)(!1);return(0,a.jsxs)("div",{className:"settings-overlay",role:"dialog","aria-modal":"true","aria-labelledby":"settings-title",children:[(0,a.jsxs)("div",{className:"settings-modal",children:[(0,a.jsxs)("div",{className:"settings-header",children:[(0,a.jsx)("h2",{id:"settings-title",children:"Account & Settings"}),(0,a.jsx)("button",{className:"close-button",onClick:e,"aria-label":"Close settings",children:"âœ•"})]}),(0,a.jsxs)("div",{className:"settings-content",children:[(0,a.jsxs)("div",{className:"setting-group",children:[(0,a.jsx)("h3",{children:"Account Status"}),(0,a.jsxs)("div",{className:"account-info",children:[(0,a.jsxs)("div",{className:"status-item",children:[(0,a.jsx)("span",{className:"label",children:"Plan:"}),(0,a.jsx)("span",{className:`status-badge tier-${t.tier}`,children:"paid"===t.tier?"Pro":"free"===t.tier?"Free":"Anonymous"})]}),"free"===t.tier&&(0,a.jsxs)("div",{className:"status-item",children:[(0,a.jsx)("span",{className:"label",children:"Daily Modifications:"}),(0,a.jsxs)("span",{className:"usage-count",children:[s(),"/3 remaining"]})]}),t.isSignedIn&&(0,a.jsxs)("div",{className:"status-item",children:[(0,a.jsx)("span",{className:"label",children:"Status:"}),(0,a.jsx)("span",{className:"signed-in",children:"âœ“ Signed In"})]})]})]}),t.isSignedIn?"paid"!==t.tier&&(0,a.jsxs)("div",{className:"setting-group upgrade-section",children:[(0,a.jsx)("h3",{children:"Upgrade to Pro"}),(0,a.jsxs)("div",{className:"upgrade-features",children:[(0,a.jsx)("div",{className:"feature",children:"âœ¨ Unlimited prompt modifications"}),(0,a.jsx)("div",{className:"feature",children:"ğŸ¯ Priority support"}),(0,a.jsx)("div",{className:"feature",children:"ğŸš€ Advanced features"})]}),(0,a.jsx)("button",{className:"upgrade-button",onClick:async()=>{if(t.isSignedIn)try{await o.openPaymentPage()}catch(e){console.error("Failed to open payment page:",e)}else alert("Please sign in first to upgrade to Pro.")},children:"Upgrade to Pro - $6.99/mo"})]}):(0,a.jsxs)("div",{className:"setting-group sign-in-section",children:[(0,a.jsx)("h3",{children:"Sign In Required"}),(0,a.jsx)("p",{children:"Sign in to access premium features and upgrade to Pro."}),(0,a.jsxs)("div",{className:"upgrade-features",children:[(0,a.jsx)("div",{className:"feature",children:"âœ¨ Save your favorite prompts"}),(0,a.jsx)("div",{className:"feature",children:"ğŸ¯ Track your usage"}),(0,a.jsx)("div",{className:"feature",children:"ğŸš€ Unlock Pro features"})]}),(0,a.jsx)("button",{className:"sign-in-button primary",onClick:async()=>{l(!0);try{await n()}catch(e){console.error("Sign in failed:",e),alert("Sign in failed. Please try again.")}finally{l(!1)}},disabled:c,children:c?"Signing In...":"ğŸ‘¤ Sign In with Google"})]}),(0,a.jsxs)("div",{className:"setting-group",children:[(0,a.jsx)("h3",{children:"About"}),(0,a.jsx)("p",{className:"about-text",children:"Veo 3 Prompt Assistant helps you create better prompts for Google's Veo 3 video AI model."}),(0,a.jsx)("div",{className:"links",children:(0,a.jsx)("button",{className:"link-button",onClick:()=>m(!0),children:"ğŸ’¬ Support & Feedback"})})]})]}),(0,a.jsxs)("div",{className:"settings-footer",children:[t.isSignedIn&&(0,a.jsx)("button",{className:"sign-out-button",onClick:async()=>{confirm("Are you sure you want to sign out?")&&(await r(),e())},children:"ğŸšª Sign Out"}),(0,a.jsx)("button",{className:"primary",onClick:e,children:"Close"})]})]}),d&&(0,a.jsx)("div",{className:"feedback-overlay",children:(0,a.jsxs)("div",{className:"feedback-modal",children:[(0,a.jsxs)("div",{className:"feedback-header",children:[(0,a.jsx)("h3",{children:"ğŸ’¬ Support & Feedback"}),(0,a.jsx)("button",{className:"close-button",onClick:()=>m(!1),"aria-label":"Close feedback modal",children:"âœ•"})]}),(0,a.jsxs)("div",{className:"feedback-content",children:[(0,a.jsx)("p",{children:"We'd love to hear from you! Your feedback helps us improve Veo 3 Prompt Assistant."}),(0,a.jsx)("div",{className:"feedback-options",children:(0,a.jsxs)("div",{className:"feedback-option",children:[(0,a.jsx)("h4",{children:"ğŸ“§ Email us directly"}),(0,a.jsx)("p",{children:"Got suggestions, bugs, or questions?"}),(0,a.jsx)("a",{href:"mailto:nemanja@memekitchen.ai?subject=Veo 3 Prompt Assistant Feedback",className:"email-link",children:"nemanja@memekitchen.ai"})]})})]}),(0,a.jsx)("div",{className:"feedback-footer",children:(0,a.jsx)("button",{className:"secondary",onClick:()=>m(!1),children:"Close"})})]})})]})},y=()=>{const[e,t]=(0,i.useState)(null),[s,r]=(0,i.useState)(!1),{}=h();(0,i.useEffect)(()=>{n()},[]);const n=async()=>{try{const e=await chrome.storage.local.get(["user"]);e.user&&t(e.user)}catch(e){console.error("Error checking auth status:",e)}};return s?(0,a.jsx)("div",{className:"google-auth",children:(0,a.jsx)("span",{className:"auth-loading",children:"Signing in..."})}):e?(0,a.jsxs)("div",{className:"google-auth signed-in",children:[e.picture&&(0,a.jsx)("img",{src:e.picture,alt:e.name||e.email,className:"user-avatar",referrerPolicy:"no-referrer"}),(0,a.jsxs)("div",{className:"user-info",children:[(0,a.jsx)("span",{className:"user-name",children:e.name||e.email}),(0,a.jsx)("button",{onClick:async()=>{try{chrome.runtime.sendMessage({type:"GOOGLE_SIGN_OUT"},e=>{e?.success&&console.log("Signed out successfully")}),await chrome.storage.local.remove(["user"]),t(null)}catch(e){console.error("Sign out error:",e)}},className:"sign-out-btn",title:"Sign out",children:"Sign Out"})]})]}):(0,a.jsx)("div",{className:"google-auth",children:(0,a.jsxs)("button",{onClick:async()=>{r(!0);try{chrome.runtime.sendMessage({type:"GOOGLE_SIGN_IN"},e=>{if(r(!1),chrome.runtime.lastError)return void console.error("Sign in error:",chrome.runtime.lastError);if(!e||!e.success)return void console.error("Sign in failed:",e?.error||"Unknown error");const s={email:e.user.email,name:e.user.name,picture:e.user.picture};t(s)})}catch(e){console.error("Sign in error:",e),r(!1)}},className:"sign-in-btn",disabled:s,children:[(0,a.jsxs)("svg",{className:"google-icon",viewBox:"0 0 24 24",width:"18",height:"18",children:[(0,a.jsx)("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,a.jsx)("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,a.jsx)("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,a.jsx)("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Sign in"]})})},f=({onClose:e,onSave:t})=>{const[s,r]=(0,i.useState)(""),[n,o]=(0,i.useState)(!1),[c,l]=(0,i.useState)(null),[d,m]=(0,i.useState)(null),[u,p]=(0,i.useState)(!1);return(0,a.jsx)("div",{className:"modal-backdrop",onClick:t=>{t.target===t.currentTarget&&e()},onKeyDown:t=>{"Escape"===t.key&&e()},children:(0,a.jsxs)("div",{className:"create-prompt-modal",role:"dialog","aria-labelledby":"create-prompt-title",children:[(0,a.jsxs)("div",{className:"modal-header",children:[(0,a.jsx)("h2",{id:"create-prompt-title",children:"âœ¨ Create New Prompt"}),(0,a.jsx)("button",{className:"close-button",onClick:e,"aria-label":"Close modal",children:"Ã—"})]}),(0,a.jsx)("div",{className:"modal-body",children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"Generated Prompt"}),(0,a.jsx)("textarea",{className:"description-input result-textarea",value:d,readOnly:!0,rows:12})]}),c&&(0,a.jsx)("div",{className:"error-message",children:c}),(0,a.jsxs)("div",{className:"modal-actions",children:[(0,a.jsxs)("div",{className:"button-group-left",children:[(0,a.jsx)("button",{className:"secondary",onClick:async()=>{if(d)try{await navigator.clipboard.writeText(d),l(null)}catch(e){l("Failed to copy. Please copy manually.")}},children:"ğŸ“‹ Copy"}),(0,a.jsx)("button",{className:"secondary",onClick:e,children:"Close"})]}),(0,a.jsx)("div",{className:"button-group-right",children:(0,a.jsx)("button",{className:"primary",onClick:()=>{if(!d)return;const e={id:`custom-${Date.now()}`,category:"my-prompts",title:s.length>50?s.substring(0,47)+"...":s,prompt:d,dateAdded:(new Date).toISOString(),isCustom:!0};t(e),p(!0)},disabled:u,children:u?"â­ Saved":"â­ Save to My Prompts"})})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"video-description",children:"Describe your video idea:"}),(0,a.jsx)("textarea",{id:"video-description",className:"description-input",value:s,onChange:e=>r(e.target.value),placeholder:"E.g., 'A tech reviewer unboxing the latest smartphone in a modern studio setup' or 'A cooking tutorial showing how to make homemade pasta'",rows:4,disabled:n})]}),c&&(0,a.jsx)("div",{className:"error-message",children:c}),(0,a.jsxs)("div",{className:"modal-actions",children:[(0,a.jsx)("div",{className:"button-group-left",children:(0,a.jsx)("button",{className:"secondary",onClick:e,disabled:n,children:"Cancel"})}),(0,a.jsx)("div",{className:"button-group-right",children:(0,a.jsx)("button",{className:"primary create-button",onClick:async()=>{if(s.trim()){o(!0),l(null);try{const e="You are an expert AI prompt engineer specializing in Google Veo 3. Transform ideas into prompts using the SSASAC framework:\n\n1) SUBJECT: Clearly identify who/what is the focus with specific details (e.g., 'grizzled detective in rumpled trench coat' not 'a man')\n2) SCENE: Describe environment in detail - where and when action occurs (e.g., 'dusty attic with afternoon light through grimy window')\n3) ACTION: Define what subject is doing with strong verbs, chain actions with 'this happens, then that happens'\n4) STYLE: Specify visual aesthetic (e.g., '1990s VHS footage', '8-bit video game', 'claymation', 'filmed on 16mm')\n5) AUDIO: Explicitly describe all sounds - dialogue, ambient sounds, SFX, and music (Veo 3's signature feature)\n6) CAMERA: Professional camera movements and shot specifications\n\nFor dialogue, use format: \"Character Name says (with emotional tone): 'Exact words.'\" - This prevents mixing up speakers.\n\nInclude negative prompt (no subtitles, no on-screen text) unless requested. Generate a professional Veo 3 prompt based on the user's description.",t=`Create a professional Veo 3 video prompt based on this idea: "${s}"\n\nFollow the JSON structure and include:\n- Detailed visual elements (subject, context, action, style, camera motion, composition, ambiance)\n- Complete audio elements (dialogue, ambient sound, sound effects, music)  \n- Technical considerations (subtitles directive, character consistency)\n\nCreate a detailed, cinematic prompt optimized for Veo 3.`,a=await new Promise(s=>{chrome.runtime.sendMessage({type:"CHANGE_PROMPT",prompt:e,instructions:t},s)});if(!a.success)throw new Error(a.error||"Failed to generate prompt");const i=a.changedPrompt;m(i),p(!1)}catch(e){console.error("Error creating prompt:",e),l(e.message||"Failed to create prompt. Please try again.")}finally{o(!1)}}else l("Please describe your video idea")},disabled:n||!s.trim(),"aria-label":n?"Creating prompt":"Create prompt",children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"loading-spinner"}),"Creating..."]}):(0,a.jsx)(a.Fragment,{children:"âœ¨ Create Prompt"})})})]})]})})]})})},b=({prompt:e,index:t,onRemove:s,onNextScene:r})=>{const[n,o]=(0,i.useState)(!1),[c,l]=(0,i.useState)(!1),[d,m]=(0,i.useState)(""),[u,p]=(0,i.useState)(!1);return(0,a.jsxs)("div",{className:"sequence-prompt-card",children:[(0,a.jsxs)("div",{className:"prompt-header",onClick:()=>o(!n),children:[(0,a.jsxs)("div",{className:"prompt-info",children:[(0,a.jsxs)("div",{className:"sequence-number",children:["#",t+1]}),(0,a.jsxs)("div",{className:"prompt-title-section",children:[(0,a.jsx)("h4",{children:e.title}),!n&&(0,a.jsxs)("p",{className:"prompt-preview",children:[e.prompt.substring(0,100),"..."]})]})]}),(0,a.jsx)("div",{className:"prompt-controls",children:(0,a.jsx)("span",{className:"expand-icon",children:n?"â–¼":"â–¶"})})]}),n&&(0,a.jsxs)("div",{className:"prompt-expanded",children:[(0,a.jsx)("p",{className:"prompt-full-text",children:e.prompt}),(0,a.jsxs)("div",{className:"prompt-actions",children:[(0,a.jsx)("button",{className:"action-btn copy-btn",onClick:async()=>{try{await navigator.clipboard.writeText(e.prompt)}catch(e){console.error("Failed to copy:",e)}},children:"ğŸ“‹ Copy"}),(0,a.jsx)("button",{className:"action-btn next-scene-btn",onClick:()=>l(!0),children:"ğŸ¬ Next Scene"}),(0,a.jsx)("button",{className:"action-btn remove-btn",onClick:s,children:"ğŸ—‘ï¸ Remove"})]})]}),c&&(0,a.jsx)("div",{className:"next-scene-modal",children:(0,a.jsxs)("div",{className:"modal-content",children:[(0,a.jsx)("h3",{children:"Create Next Scene"}),(0,a.jsx)("p",{children:"Describe what happens in the next scene. Characters and style will be preserved."}),(0,a.jsx)("textarea",{value:d,onChange:e=>m(e.target.value),placeholder:"e.g., The character walks into a coffee shop and orders a latte, then sits by the window watching the rain",rows:4}),(0,a.jsxs)("div",{className:"modal-actions",children:[(0,a.jsx)("button",{className:"cancel-btn",onClick:()=>l(!1),disabled:u,children:"Cancel"}),(0,a.jsx)("button",{className:"generate-btn",onClick:async()=>{if(d.trim()){p(!0);try{await r(e,d),l(!1),m("")}catch(e){console.error("Failed to generate next scene:",e)}finally{p(!1)}}},disabled:!d.trim()||u,children:u?"â³ Generating...":"âœ¨ Generate Scene"})]})]})})]})},w=({onClose:e})=>{const[t,s]=(0,i.useState)([]),[r,n]=(0,i.useState)(null),[o,c]=(0,i.useState)(!0),[l,d]=(0,i.useState)(!1),[m,u]=(0,i.useState)(""),[p,h]=(0,i.useState)(!1);(0,i.useEffect)(()=>{g()},[]);const g=async()=>{c(!0);try{const e=(await chrome.storage.local.get(["sequences"])).sequences||[];s(e)}catch(e){console.error("Failed to load sequences:",e)}c(!1)},y=async e=>{try{await chrome.storage.local.set({sequences:e}),s(e)}catch(e){console.error("Failed to save sequences:",e)}},w=async()=>{if(!m.trim())return;const e={id:`sequence-${Date.now()}`,name:m.trim(),prompts:[],createdAt:(new Date).toISOString()},s=[...t,e];await y(s),u(""),d(!1),n(e)},x=async e=>{if(!r)return;const s={...r,prompts:[...r.prompts,e]},a=t.map(e=>e.id===r.id?s:e);await y(a),n(s)},v=async(e,t)=>{if(!r)return;const s=`\n    Continue this video sequence with the next scene. Create a flowing, narrative prompt that naturally follows the previous scene.\n    \n    Previous scene: ${e.prompt}\n    \n    Next scene direction: ${t}\n    \n    ESSENTIAL: Maintain perfect continuity - same characters (exact descriptions, clothing, appearance), same visual style, same cinematography approach, same mood and atmosphere. Let the story flow naturally from the previous scene while incorporating the new direction. Create smooth transitions and keep the cinematic narrative alive.\n    `;try{const t=await new Promise(t=>{chrome.runtime.sendMessage({type:"CHANGE_PROMPT",prompt:e.prompt,instructions:s},t)});if(!t.success)throw new Error(t.error||"Failed to generate next scene");const a=t.changedPrompt,i={id:`scene-${Date.now()}`,category:e.category,title:`${e.title} - Scene ${r.prompts.length+1}`,prompt:a,dateAdded:(new Date).toISOString(),isCustom:!0};await x(i)}catch(e){throw console.error("Failed to generate next scene:",e),e}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"modal-backdrop",onClick:t=>{t.target===t.currentTarget&&e()},onKeyDown:t=>{"Escape"===t.key&&e()},children:(0,a.jsxs)("div",{className:"sequences-modal",role:"dialog","aria-labelledby":"sequences-title",children:[(0,a.jsxs)("div",{className:"modal-header",children:[(0,a.jsx)("h2",{id:"sequences-title",children:"ğŸ¬ Sequences"}),(0,a.jsx)("button",{className:"close-button",onClick:e,"aria-label":"Close modal",children:"Ã—"})]}),(0,a.jsx)("div",{className:"modal-body",children:r?r?(0,a.jsxs)("div",{className:"sequence-details",children:[(0,a.jsxs)("div",{className:"sequence-header",children:[(0,a.jsx)("button",{className:"back-button",onClick:()=>n(null),children:"â† Back to Sequences"}),(0,a.jsx)("h3",{children:r.name})]}),(0,a.jsx)("div",{className:"sequence-actions",children:(0,a.jsx)("button",{className:"add-prompt-btn",onClick:()=>h(!0),children:"âœ¨ Add New Prompt"})}),(0,a.jsx)("div",{className:"sequence-prompts",children:0===r.prompts.length?(0,a.jsxs)("div",{className:"empty-sequence",children:[(0,a.jsx)("p",{children:"This sequence is empty."}),(0,a.jsx)("p",{children:'Click "Add New Prompt" to create a prompt for this sequence.'})]}):(0,a.jsx)("div",{className:"prompts-list",children:r.prompts.map((e,s)=>(0,a.jsx)(b,{prompt:e,index:s,onRemove:()=>(async e=>{if(!r)return;const s={...r,prompts:r.prompts.filter((t,s)=>s!==e)},a=t.map(e=>e.id===r.id?s:e);await y(a),n(s)})(s),onNextScene:v},s))})})]}):null:(0,a.jsxs)("div",{className:"sequences-list",children:[(0,a.jsxs)("div",{className:"sequences-header",children:[(0,a.jsx)("h3",{children:"Your Sequences"}),(0,a.jsx)("button",{className:"create-sequence-btn",onClick:()=>d(!0),children:"+ New Sequence"})]}),l&&(0,a.jsxs)("div",{className:"create-sequence-form",children:[(0,a.jsx)("input",{type:"text",placeholder:"Sequence name (e.g., 'Product Launch Campaign')",value:m,onChange:e=>u(e.target.value),onKeyDown:e=>"Enter"===e.key&&w(),autoFocus:!0}),(0,a.jsxs)("div",{className:"form-actions",children:[(0,a.jsx)("button",{onClick:()=>d(!1),children:"Cancel"}),(0,a.jsx)("button",{onClick:w,disabled:!m.trim(),children:"Create"})]})]}),o?(0,a.jsx)("div",{className:"loading",children:"Loading sequences..."}):0===t.length?(0,a.jsxs)("div",{className:"empty-state",children:[(0,a.jsx)("p",{children:"No sequences created yet."}),(0,a.jsx)("p",{children:"Create a sequence to organize multiple prompts for a video series or campaign."})]}):(0,a.jsx)("div",{className:"sequences-grid",children:t.map(e=>(0,a.jsxs)("div",{className:"sequence-card",onClick:()=>n(e),children:[(0,a.jsxs)("div",{className:"sequence-info",children:[(0,a.jsx)("h4",{children:e.name}),(0,a.jsxs)("p",{children:[e.prompts.length," prompts"]}),(0,a.jsxs)("span",{className:"sequence-date",children:["Created ",new Date(e.createdAt).toLocaleDateString()]})]}),(0,a.jsx)("button",{className:"delete-sequence-btn",onClick:s=>{s.stopPropagation(),(async e=>{if(!confirm("Are you sure you want to delete this sequence?"))return;const s=t.filter(t=>t.id!==e);await y(s),r?.id===e&&n(null)})(e.id)},title:"Delete sequence",children:"ğŸ—‘ï¸"})]},e.id))})]})})]})}),p&&(0,a.jsx)(f,{onClose:()=>h(!1),onSave:async e=>{await x(e),h(!1)}})]})},x=({isOpen:e,onClose:t,feature:s,message:r,userState:n,onSignIn:o,onUpgrade:c})=>{const[l,d]=(0,i.useState)(!1);if(!e)return null;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"modal-overlay",onClick:t}),(0,a.jsxs)("div",{className:"upgrade-modal",children:[(0,a.jsx)("button",{className:"modal-close",onClick:t,children:"Ã—"}),(0,a.jsxs)("div",{className:"modal-header",children:[(0,a.jsxs)("h2",{children:["Unlock ",s]}),(0,a.jsx)("p",{className:"modal-message",children:r})]}),(0,a.jsxs)("div",{className:"upgrade-options",children:[!n.isSignedIn&&(0,a.jsxs)("div",{className:"upgrade-option",children:[(0,a.jsx)("div",{className:"option-icon",children:"ğŸ‘¤"}),(0,a.jsx)("h3",{children:"Sign Up Free"}),(0,a.jsx)("p",{children:"Create a free account to save prompts and track your favorites"}),(0,a.jsxs)("ul",{className:"feature-list",children:[(0,a.jsx)("li",{children:"âœ“ Save unlimited prompts"}),(0,a.jsx)("li",{children:"âœ“ Organize your favorites"}),(0,a.jsx)("li",{children:"âœ“ 10 free AI generations"})]}),(0,a.jsx)("button",{className:"option-button primary",onClick:async()=>{if(o){d(!0);try{await o(),t()}catch(e){console.error("Sign in failed:",e)}finally{d(!1)}}},disabled:l,children:l?"Signing in...":"Sign Up with Google"})]}),n.isSignedIn&&(0,a.jsxs)("div",{className:"upgrade-option featured",children:[(0,a.jsx)("div",{className:"option-icon",children:"â­"}),(0,a.jsx)("h3",{children:"Upgrade to Pro"}),(0,a.jsx)("p",{children:"Unlock unlimited AI modifications and premium features"}),(0,a.jsxs)("ul",{className:"feature-list",children:[(0,a.jsx)("li",{children:"âœ“ Unlimited AI prompt modifications"}),(0,a.jsx)("li",{children:"âœ“ Create unlimited new prompts"}),(0,a.jsx)("li",{children:"âœ“ Priority support"}),(0,a.jsx)("li",{children:"âœ“ Advanced features"})]}),(0,a.jsx)("button",{className:"option-button premium",onClick:c,children:"Upgrade to Pro - $6.99/mo"}),(0,a.jsx)("span",{className:"option-note",children:"Best value for creators"})]})]}),n.isSignedIn&&"free"===n.tier&&(0,a.jsx)("div",{className:"usage-remaining",children:(0,a.jsxs)("span",{className:"usage-badge",children:[3-n.dailyModificationsUsed,"/3 free modifications today"]})})]})]})},v=({searchQuery:e="",onSearch:t,onPromptCreated:s})=>{const[r,n]=(0,i.useState)(!1),[c,l]=(0,i.useState)(!1),[d,m]=(0,i.useState)(!1),[u,p]=(0,i.useState)(!1),{userState:b,canAccess:v,getRemainingModifications:S}=h(),j=()=>{console.log("Upgrade clicked!"),p(!0)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("header",{className:"header",children:[(0,a.jsxs)("div",{className:"header-main",children:[(0,a.jsx)("div",{className:"header-left",children:(0,a.jsx)("img",{src:"/icons/icon32.svg",alt:"VeoPrompter Logo",className:"header-logo"})}),(0,a.jsxs)("div",{className:"header-right",children:[t&&(0,a.jsxs)("div",{className:"search-container",children:[(0,a.jsx)("input",{type:"text",className:"search-input",placeholder:"Search...",value:e,onChange:e=>t(e.target.value),"aria-label":"Search prompts"}),(0,a.jsx)("span",{className:"search-icon","aria-hidden":"true",children:"ğŸ”"})]}),(0,a.jsx)("div",{className:"user-status-compact",children:b.isSignedIn?(0,a.jsxs)("div",{className:"user-info-compact",children:[(0,a.jsx)("button",{className:`user-tier-badge-compact tier-${b.tier} ${"free"===b.tier?"clickable":""}`,onClick:"free"===b.tier?j:void 0,disabled:"paid"===b.tier,title:"free"===b.tier?"Click to upgrade to Pro":"Pro plan",children:"paid"===b.tier?"â­":"ğŸ"}),"free"===b.tier&&(0,a.jsxs)("button",{className:`modifications-count-compact ${0===S()?"limit-reached":""} clickable`,onClick:j,title:"Click to upgrade for unlimited modifications",children:[S(),"/3"]})]}):(0,a.jsx)(y,{})}),(0,a.jsx)("button",{className:"icon-button",onClick:()=>{n(!0)},"aria-label":"Open settings",children:"âš™ï¸"})]})]}),(v("createPrompts")||v("createSequences"))&&(0,a.jsxs)("div",{className:"header-actions-compact",children:[v("createPrompts")&&(0,a.jsx)("button",{className:"action-button-compact create-prompt-btn",onClick:()=>l(!0),title:"Create new prompt with AI",children:"âœ¨ Create New Prompt"}),v("createSequences")&&(0,a.jsx)("button",{className:"action-button-compact sequences-btn",onClick:()=>m(!0),title:"Manage sequences",children:"ğŸ¬ Sequences"})]})]}),r&&(0,a.jsx)(g,{onClose:()=>{n(!1)}}),c&&(0,a.jsx)(f,{onClose:()=>l(!1),onSave:async e=>{const t=[...(await chrome.storage.local.get(["savedPrompts"])).savedPrompts||[],e];await chrome.storage.local.set({savedPrompts:t}),s&&s(e)}}),d&&(0,a.jsx)(w,{onClose:()=>m(!1)}),u&&(0,a.jsx)(x,{isOpen:u,onClose:()=>p(!1),feature:"Pro Features",message:"Upgrade to Pro for unlimited modifications and advanced features",userState:b,onUpgrade:async()=>{try{await o.openPaymentPage()}catch(e){console.error("Failed to open payment page:",e)}p(!1)}})]})},S=[{id:"1",name:"my-prompts",icon:"â­",description:"Your saved and custom prompts",color:"#FECA57"},{id:"2",name:"ads",icon:"ğŸ“º",description:"Commercial and advertising prompts",color:"#FF6B6B"},{id:"3",name:"storytelling",icon:"ğŸ“–",description:"Narrative and story-driven content",color:"#4ECDC4"},{id:"4",name:"tutorial",icon:"ğŸ“",description:"Educational and how-to content",color:"#45B7D1"},{id:"5",name:"vlogging",icon:"ğŸ“¹",description:"Personal vlog and lifestyle content",color:"#96CEB4"},{id:"6",name:"mobile-game",icon:"ğŸ®",description:"Mobile game ads and gameplay",color:"#A8E6CF"},{id:"7",name:"street-interview",icon:"ğŸ¤",description:"Street interviews and social content",color:"#FF8B94"},{id:"8",name:"tech-influencer",icon:"ğŸ’»",description:"Tech reviews and influencer content",color:"#B4A7D6"}],j=({onCategorySelect:e})=>(0,a.jsx)("main",{className:"category-grid",role:"main","aria-label":"Prompt categories",children:S.map(t=>{const s=t.name.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");return(0,a.jsxs)("div",{className:"category-card",onClick:()=>e(t.name),onKeyDown:s=>((t,s)=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),e(s))})(s,t.name),style:{borderColor:t.color},role:"button",tabIndex:0,"aria-label":`${s} category. ${t.description}`,children:[(0,a.jsx)("div",{className:"category-icon",style:{backgroundColor:t.color+"20"},"aria-hidden":"true",children:t.icon}),(0,a.jsx)("h3",{className:"category-name",children:s}),(0,a.jsx)("p",{className:"category-description",children:t.description}),(0,a.jsx)("span",{className:"category-count","aria-label":"Click to view prompts in this category",children:"View prompts"})]},t.id)})}),N=new class{constructor(){this.prompts=[],this.loaded=!1,this.unsubscribe=null,this.updateCallbacks=new Set}async initialize(){console.log("ğŸ”„ Starting prompt data initialization...");try{console.log("ğŸ”¥ Trying Firebase for real-time sync...");const e=await this.loadFromFirebase();if(e.length>0)return console.log(`âœ… Loaded ${e.length} prompts from Firebase with real-time sync`),this.prompts=e,this.loaded=!0,e}catch(e){console.warn("âš ï¸ Firebase failed, trying fallbacks:",e)}try{console.log("ğŸ“Š Trying admin dashboard static data...");const e=await this.loadFromAdminDashboard();if(e.length>0)return console.log(`âœ… Loaded ${e.length} prompts from admin dashboard (static)`),this.prompts=e,this.loaded=!0,e}catch(e){console.warn("âŒ Admin dashboard failed:",e)}try{console.log("ğŸ“‹ Falling back to prompts.txt...");const e=await this.loadFromPromptsFile();return console.log(`âœ… Loaded ${e.length} prompts from prompts.txt`),this.prompts=e,this.loaded=!0,e}catch(e){console.error("âŒ All data sources failed:",e);const t=this.getDefaultPrompts();return this.prompts=t,this.loaded=!0,t}}async loadFromFirebase(){try{return await m.initialize(),new Promise((e,t)=>{let s=!1;const a=setTimeout(()=>{s||(console.warn("â±ï¸ Firebase timeout - no data received within 5 seconds"),s=!0,t(new Error("Firebase timeout")))},5e3);this.unsubscribe=m.subscribeToPrompts(t=>{if(!t)return console.warn("ğŸ“­ Firebase returned null/undefined prompts"),void(s||(clearTimeout(a),s=!0,e([])));console.log("ğŸ”¥ Firebase raw data:",t),this.prompts=t.map((e,t)=>({id:e.id||`firebase-${t+1}`,category:e.category,title:e.title,prompt:e.prompt,youtubeLink:e.youtubeLink,dateAdded:e.dateAdded||(new Date).toISOString(),isCustom:!1})),this.loaded=!0,console.log(`ğŸ”„ Firebase update: ${this.prompts.length} prompts processed`),this.notifySubscribers(),s||(clearTimeout(a),s=!0,e(this.prompts))})})}catch(e){return console.warn("Failed to load from Firebase:",e),[]}}subscribeToUpdates(e){return this.updateCallbacks.add(e),this.loaded&&this.prompts.length>0&&e(this.prompts),this.unsubscribe||this.loaded||(console.log("ğŸ”„ Late subscriber detected, initializing Firebase..."),this.initialize().catch(e=>{console.error("Failed to initialize for late subscriber:",e)})),()=>{this.updateCallbacks.delete(e)}}notifySubscribers(){this.updateCallbacks.forEach(e=>{e(this.prompts)})}async loadFromAdminDashboard(){const e=chrome.runtime.getURL("admin-dashboard/prompts-data.json"),t=await fetch(e);if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const s=await t.json();if(console.log("Fetched admin dashboard JSON data"),s&&s.prompts&&Array.isArray(s.prompts)){const e=s.prompts;console.log(`Converting ${e.length} admin prompts to internal format`);const t=e.map((e,t)=>({id:`admin-${t+1}`,category:e.category,title:e.title,prompt:e.prompt,youtubeLink:e.youtubeLink,dateAdded:(new Date).toISOString(),isCustom:!1}));return console.log(`âœ… Successfully converted ${t.length} prompts`),t}throw new Error("Invalid JSON structure - prompts not found or not array")}async loadFromPromptsFile(){const e=chrome.runtime.getURL("data/prompts.txt"),t=await fetch(e);if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const s=(await t.text()).split("\n").filter(e=>e.trim()&&!e.startsWith("#")).map((e,t)=>{const[s,a,i,r]=e.split("|").map(e=>e.trim());return{id:`prompt-${t+1}`,category:s,title:a,prompt:i,youtubeLink:r||void 0,dateAdded:(new Date).toISOString(),isCustom:!1}}).filter(e=>e.title&&e.prompt);return console.log(`âœ… Successfully parsed ${s.length} prompts from prompts.txt`),s}async getPrompts(){return this.loaded||await this.initialize(),this.prompts}async getPromptsByCategory(e){const t=await this.getPrompts();return"all"===e?t:"my-prompts"===e?(await chrome.storage.local.get(["savedPrompts"])).savedPrompts||[]:t.filter(t=>t.category===e)}async searchPrompts(e){const t=await this.getPrompts(),s=e.toLowerCase();return t.filter(e=>e.title.toLowerCase().includes(s)||e.prompt.toLowerCase().includes(s)||e.category.toLowerCase().includes(s))}getDefaultPrompts(){return[{id:"default-1",category:"ads",title:"Product Launch Teaser",prompt:"Create a 30-second teaser video for a new tech product launch.",dateAdded:(new Date).toISOString(),isCustom:!1},{id:"default-2",category:"storytelling",title:"Mystery Opening",prompt:"Create an opening scene for a mystery short film.",dateAdded:(new Date).toISOString(),isCustom:!1},{id:"default-3",category:"tutorial",title:"Cooking Tutorial",prompt:"Film a cooking tutorial with overhead shots.",dateAdded:(new Date).toISOString(),isCustom:!1},{id:"default-4",category:"vlogging",title:"Day in My Life",prompt:'Film a "day in my life" vlog.',dateAdded:(new Date).toISOString(),isCustom:!1}]}async reload(){return this.loaded=!1,this.prompts=[],this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null),this.initialize()}cleanup(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null),m.unsubscribeFromPrompts()}};class P{constructor(){this.apiKey=null,this.knowledgeBase=null,this.secureStorage=null,"undefined"!=typeof SecureStorage&&(this.secureStorage=new SecureStorage)}static getInstance(){return P.instance||(P.instance=new P),P.instance}async loadKnowledgeBase(){if(this.knowledgeBase)return this.knowledgeBase;try{const e="undefined"!=typeof chrome&&chrome.runtime?chrome.runtime.getURL("data/knowledge-base.json"):"/data/knowledge-base.json",t=await fetch(e);return this.knowledgeBase=await t.json(),this.knowledgeBase}catch(e){return console.error("Failed to load knowledge base:",e),null}}generateSystemPrompt(e){return'You MUST respond ONLY with valid JSON. No other text.\n\n{\n  "prompt": "flowing, narrative Veo 3 video prompt",\n  "core_elements": {\n    "subject": "who/what",\n    "context": "where", \n    "action": "what happens",\n    "style": "visual mood"\n  },\n  "optional_elements": {\n    "camera": "movement",\n    "dialogue": "speech",\n    "sounds": "audio"\n  }\n}\n\nWrite cinematic, flowing prompts that adapt to different contexts (ads, interviews, home videos, sketches, etc.). Be flexible and logical - don\'t copy inappropriate details from one context to another. CRITICAL: Follow user instructions exactly - implement every requested change. JSON format only.'}async setApiKey(e){if(!e)return this.secureStorage?await this.secureStorage.removeApiKey():await chrome.storage.local.remove(["gptApiKey"]),void(this.apiKey=null);try{this.secureStorage?(await this.secureStorage.storeApiKey(e),this.apiKey=e):(this.apiKey=e,await chrome.storage.local.set({gptApiKey:e}))}catch(e){throw console.error("Failed to store API key:",e),e}}async getApiKey(){if(this.apiKey)return this.apiKey;try{if(this.secureStorage)return await this.secureStorage.migrateOldKey(),this.apiKey=await this.secureStorage.getApiKey(),this.apiKey;{const e=await chrome.storage.local.get(["gptApiKey"]);return this.apiKey=e.gptApiKey||null,this.apiKey}}catch(e){return console.error("Failed to retrieve API key:",e),this.apiKey=null,null}}async modifyPrompt(e){if(!e.instruction?.trim())throw new Error("ğŸ“ Modification instruction required: Please describe how you want to modify the prompt.");const t=await this.loadKnowledgeBase(),s=this.generateSystemPrompt(t);try{let t=await fetch("https://veoprompter.netlify.app/.netlify/functions/gpt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"gpt-4o",systemPrompt:s,prompt:e.prompt,instruction:e.instruction,temperature:.7,maxTokens:800})});if(!t.ok){const e=await t.json().catch(()=>({})),s=e.error?.message||e.message;if(console.error("GPT API Response Error:",{status:t.status,statusText:t.statusText,errorData:e,url:t.url}),401===t.status)throw new Error("ğŸ” Unauthorized: Backend API key invalid or missing.");if(403===t.status)throw new Error("ğŸš« Access denied by backend.");if(429===t.status)throw new Error("â° Rate limit exceeded. Please try again later.");if(t.status>=500)throw new Error("ğŸ”§ Server error: Please try again shortly.");if(400===t.status)throw new Error(`ğŸ“ Bad request: ${s||"Invalid prompt or instruction format."}`);if(404===t.status)throw new Error("ğŸ”§ Service unavailable: The AI modification service is not currently deployed. Please contact support.");throw new Error(`âŒ Request failed (${t.status}): ${s||t.statusText||"Please try again."}`)}const a=await t.json();if(!a?.content)throw new Error("ğŸ“­ Empty response: The AI didn't generate a response. Please try again with a different instruction.");let i;try{const e=JSON.parse(a.content);i=e.prompt?String(e.prompt).trim():String(a.content).trim()}catch(e){i=String(a.content).trim()}return i}catch(e){if(console.error("GPT API error:",e),e instanceof TypeError&&e.message.includes("fetch"))throw new Error("ğŸŒ Connection failed: Please check your internet connection and try again.");throw e}}}class C{constructor(){}static getInstance(){return C.instance||(C.instance=new C),C.instance}async getMonthlyUsage(e){try{const t=`imageUsage_${e}`,s=(await chrome.storage.local.get([t]))[t]||{count:0,lastReset:0},a=Date.now(),i=new Date(a).getMonth(),r=new Date(a).getFullYear(),n=new Date(s.lastReset),o=n.getMonth(),c=n.getFullYear();if(i!==o||r!==c){const e={count:0,lastReset:a};return await chrome.storage.local.set({[t]:e}),e}return s}catch(e){return console.error("Failed to get monthly usage:",e),{count:0,lastReset:Date.now()}}}async incrementUsage(e){try{const t=`imageUsage_${e}`,s=await this.getMonthlyUsage(e);s.count+=1,await chrome.storage.local.set({[t]:s})}catch(e){console.error("Failed to increment usage:",e)}}async canGenerateImage(e){try{if("paid"!==p.getUserState().tier)return{allowed:!1,reason:"Premium subscription required for image generation"};const t=await this.getMonthlyUsage(e),s=125-t.count;return t.count>=125?{allowed:!1,reason:"Monthly image generation limit reached (125/month)",remaining:0}:{allowed:!0,remaining:s}}catch(e){return console.error("Failed to check generation permissions:",e),{allowed:!1,reason:"Failed to check permissions"}}}async generateFirstFrame(e){if(!e.prompt?.trim())throw new Error("ğŸ“ Prompt is required for image generation");if(!e.userId?.trim())throw new Error("ğŸ” User ID is required for rate limiting");const t=await this.canGenerateImage(e.userId);if(!t.allowed)throw new Error(t.reason||"Image generation not allowed");try{const t=await fetch("https://veoprompter.netlify.app/.netlify/functions/google-ai-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json().catch(()=>({})),s=e.error?.message||e.message;if(console.error("Image Generation API Response Error:",{status:t.status,statusText:t.statusText,errorData:e,url:t.url}),401===t.status)throw new Error("ğŸ” Unauthorized: Backend API key invalid or missing");if(403===t.status)throw new Error("ğŸš« Access denied by backend");if(429===t.status)throw new Error("â° Rate limit exceeded. Please try again later");if(t.status>=500)throw new Error("ğŸ”§ Server error: Please try again shortly");if(400===t.status)throw new Error(`ğŸ“ Bad request: ${s||"Invalid prompt format"}`);throw new Error(`âŒ Request failed (${t.status}): ${s||t.statusText||"Please try again"}`)}const s=await t.json();if(!s?.success||!s?.imageUrl)throw new Error("ğŸ“­ No image generated: Please try again with a different prompt");return await this.incrementUsage(e.userId),s}catch(e){if(console.error("Image generation error:",e),e instanceof TypeError&&e.message.includes("fetch"))throw new Error("ğŸŒ Connection failed: Please check your internet connection and try again");throw e}}async getRemainingGenerations(e){try{const t=await this.getMonthlyUsage(e);return Math.max(0,125-t.count)}catch(e){return console.error("Failed to get remaining generations:",e),0}}}const k=({message:e})=>(0,a.jsx)("div",{className:"toast",role:"status","aria-live":"polite","aria-atomic":"true",children:e}),A=({prompt:e,onSave:t,onRemove:s,isSaved:r,isCustomPrompt:n=!1})=>{const[o,c]=(0,i.useState)(!1),[l,d]=(0,i.useState)(!1),[m,u]=(0,i.useState)(""),[p,g]=(0,i.useState)(!1),[y,f]=(0,i.useState)(""),[b,w]=(0,i.useState)(e.prompt),[v,S]=(0,i.useState)(!1),[j,N]=(0,i.useState)(!1),[A,I]=(0,i.useState)(""),[F,E]=(0,i.useState)(""),[U,D]=(0,i.useState)(!1),[T,M]=(0,i.useState)([]),[O,q]=(0,i.useState)(!1),[$,L]=(0,i.useState)(null),[R,z]=(0,i.useState)(!1),{userState:_,canAccess:G,getUpgradeMessage:B,signIn:K,trackModification:Y,getRemainingModifications:J}=h(),V=e=>{u(e),d(!0),setTimeout(()=>d(!1),3e3)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"prompt-card",children:[(0,a.jsxs)("div",{className:"prompt-header",onClick:()=>c(!o),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),c(!o))},role:"button",tabIndex:0,"aria-expanded":o,"aria-controls":`prompt-content-${e.id}`,"aria-label":`${o?"Collapse":"Expand"} prompt: ${e.title}`,children:[(0,a.jsx)("h3",{className:"prompt-title",children:e.title}),(0,a.jsx)("span",{className:"expand-icon","aria-hidden":"true",children:o?"â–¼":"â–¶"})]}),o&&(0,a.jsxs)("div",{className:"prompt-content",id:`prompt-content-${e.id}`,role:"region","aria-label":"Prompt details",children:[(0,a.jsx)("p",{className:"prompt-text",children:b}),p?(0,a.jsxs)("div",{className:"modify-section",children:[(0,a.jsx)("textarea",{className:"modify-input",placeholder:"How would you like to modify this prompt? (e.g., 'make it more dramatic', 'add slow motion effects')",value:y,onChange:e=>f(e.target.value)}),(0,a.jsxs)("div",{className:"modify-actions",children:[(0,a.jsx)("button",{className:"secondary",onClick:()=>g(!1),disabled:v,children:"Cancel"}),(0,a.jsx)("button",{className:"primary",onClick:async()=>{if(y.trim()){if("free"===_.tier&&!await Y())return I("Daily Limit Reached"),E("You've used all 3 free modifications today. Upgrade for unlimited access!"),void N(!0);S(!0);try{const e=P.getInstance(),t=await e.modifyPrompt({prompt:b,instruction:y});w(t),g(!1),f("");const s=J();"free"===_.tier&&s>0?V(`âœ¨ Prompt modified! ${s} free modifications left today.`):"free"===_.tier&&0===s?V("âœ¨ Prompt modified! That was your last free modification for today."):V("âœ¨ Prompt modified successfully!")}catch(e){console.error("Failed to modify prompt:",e);const t=e instanceof Error?e.message:"âŒ Failed to modify prompt";V(t)}finally{S(!1)}}else V("ğŸ“ Please enter a modification instruction")},disabled:v||!y.trim(),"aria-label":v?"Modifying prompt, please wait":"Apply modification to prompt",children:v?"â³ Modifying...":"âœ¨ Apply"})]})]}):(0,a.jsxs)("div",{className:"prompt-actions",role:"group","aria-label":"Prompt actions",children:[(0,a.jsx)("button",{className:"action-button",onClick:async()=>{try{await navigator.clipboard.writeText(b),V("ğŸ“‹ Prompt copied to clipboard!")}catch(e){try{const e=document.createElement("textarea");e.value=b,e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.select();const t=document.execCommand("copy");if(document.body.removeChild(e),!t)throw new Error("Copy command failed");V("ğŸ“‹ Prompt copied to clipboard!")}catch(e){console.error("Copy failed:",e),V("âŒ Failed to copy: Please select and copy the text manually")}}},"aria-label":"Copy prompt to clipboard",children:"ğŸ“‹ Copy"}),(0,a.jsx)("button",{className:"action-button "+(G("createSequences")?"":"locked"),onClick:async()=>{if(!G("createSequences"))return I("Sequences"),E(B("createSequences")),void N(!0);const e=(await chrome.storage.local.get(["sequences"])).sequences||[];0!==e.length?(M(e),D(!0)):V("ğŸ“ Create a sequence first in the Sequences menu")},"aria-label":"Add to sequence",children:"ğŸ¬ Add to Sequence"}),(0,a.jsxs)("button",{className:"action-button "+(G("modifyPrompts")?"":"locked"),onClick:()=>{if(!G("modifyPrompts"))return I("AI Prompt Modification"),E(B("modifyPrompts")),void N(!0);g(!0)},"aria-label":G("modifyPrompts")?"Modify this prompt using AI":"Modify prompt (requires API key or subscription)",children:["âœï¸ Modify ",!G("modifyPrompts")&&"ğŸ”’"]}),(0,a.jsx)("button",{className:"action-button",onClick:()=>{if(e.youtubeLink){const t=1e3,s=700,a=window.screenX+(window.outerWidth-t)/2,i=window.screenY+(window.outerHeight-s)/2,r=window.open(e.youtubeLink,"video-preview",`width=${t},height=${s},left=${a},top=${i},toolbar=no,menubar=no,location=no,status=no,resizable=yes,scrollbars=yes`);r&&r.focus()}else V("ğŸ¬ Preview coming soon!")},"aria-label":"Preview example video",children:"â–¶ï¸ Preview"}),n&&(0,a.jsx)("button",{className:"action-button",onClick:async()=>{if(!_.isSignedIn)return I("Generate First Frame"),E("Sign in required to generate first frame images"),void N(!0);q(!0);try{const e=C.getInstance(),t=await e.canGenerateImage(_.userId||"");if(!t.allowed)return I("Generate First Frame"),E(t.reason||"Image generation not available"),void N(!0);const s=await e.generateFirstFrame({prompt:b,userId:_.userId||""});L(s.imageUrl),z(!0);const a=await e.getRemainingGenerations(_.userId||"");V(`ğŸ¨ First frame generated! ${a} generations remaining this month.`)}catch(e){console.error("Failed to generate first frame:",e);const t=e instanceof Error?e.message:"Failed to generate first frame";V(t)}finally{q(!1)}},disabled:O,"aria-label":"Generate first frame image from prompt",children:O?"ğŸ¨ Generating...":"ğŸ¨ First Frame"}),t&&!r&&(0,a.jsx)("button",{className:"action-button",onClick:async()=>{if(t){if(!G("savePrompts"))return I("Save Prompts"),E(B("savePrompts")),void N(!0);t(e),V("â­ Prompt saved successfully!")}},"aria-label":"Save prompt to favorites",children:"â­ Save"}),s&&(0,a.jsx)("button",{className:"action-button remove-prompt-btn",onClick:()=>{s&&confirm("Are you sure you want to remove this prompt from your collection?")&&(s(e),V("ğŸ—‘ï¸ Prompt removed from My Prompts"))},"aria-label":"Remove prompt from My Prompts",children:"ğŸ—‘ï¸ Remove"})]})]})]}),l&&(0,a.jsx)(k,{message:m}),(0,a.jsx)(x,{isOpen:j,onClose:()=>N(!1),feature:A,message:F,userState:_,onSignIn:K,onAddApiKey:()=>{V("API key management coming soon!")},onUpgrade:()=>{V("Upgrade flow coming soon!")}}),U&&(0,a.jsx)("div",{className:"sequence-selector-modal",children:(0,a.jsxs)("div",{className:"modal-content",children:[(0,a.jsx)("h3",{children:"Select Sequence"}),(0,a.jsx)("p",{children:"Choose which sequence to add this prompt to:"}),(0,a.jsx)("div",{className:"sequences-list",children:T.map(t=>(0,a.jsx)("button",{className:"sequence-option",onClick:()=>(async t=>{t.prompts.push(e);const s=((await chrome.storage.local.get(["sequences"])).sequences||[]).map(e=>e.id===t.id?t:e);await chrome.storage.local.set({sequences:s}),V(`ğŸ¬ Added to "${t.name}"`),D(!1)})(t),children:(0,a.jsxs)("div",{className:"sequence-info",children:[(0,a.jsx)("strong",{children:t.name}),(0,a.jsxs)("span",{children:[t.prompts.length," prompts"]})]})},t.id))}),(0,a.jsx)("button",{className:"cancel-sequence-btn",onClick:()=>D(!1),children:"Cancel"})]})}),R&&$&&(0,a.jsx)("div",{className:"image-modal-overlay",onClick:()=>z(!1),children:(0,a.jsxs)("div",{className:"image-modal",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"image-modal-header",children:[(0,a.jsx)("h3",{children:"Generated First Frame"}),(0,a.jsx)("button",{className:"close-button",onClick:()=>z(!1),"aria-label":"Close image modal",children:"âœ•"})]}),(0,a.jsxs)("div",{className:"image-modal-content",children:[(0,a.jsx)("img",{src:$,alt:"Generated first frame",className:"generated-image"}),(0,a.jsx)("p",{className:"image-prompt-text",children:b})]}),(0,a.jsxs)("div",{className:"image-modal-actions",children:[(0,a.jsx)("button",{className:"secondary",onClick:()=>z(!1),children:"Close"}),(0,a.jsx)("button",{className:"primary",onClick:()=>{if(!$)return;const t=document.createElement("a");t.href=$,t.download=`first-frame-${e.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()}.png`,document.body.appendChild(t),t.click(),document.body.removeChild(t),V("ğŸ“¥ Image downloaded!")},children:"ğŸ“¥ Download"})]})]})})]})},I=({category:e,searchQuery:t="",onBack:s})=>{const[r,n]=(0,i.useState)([]),[o,c]=(0,i.useState)([]),[l,d]=(0,i.useState)(!0);(0,i.useEffect)(()=>{if(d(!0),"my-prompts"===e)return void(async()=>{const e=await chrome.storage.local.get(["savedPrompts"]);c(e.savedPrompts||[]),d(!1)})();const t=N.subscribeToUpdates(t=>{const s=(new Date).toLocaleTimeString();if(console.log(`ğŸ“¡ [${s}] Component received real-time update:`,t.length,"prompts"),"all"===e)console.log(`âœ… [${s}] Setting ALL prompts:`,t.length),n(t);else{const a=t.filter(t=>t.category===e);console.log(`âœ… [${s}] Setting filtered prompts for category '${e}':`,a.length),n(a)}d(!1)});return N.initialize().catch(e=>{console.error("Failed to initialize prompts:",e),d(!1)}),()=>{t()}},[e]);const m=async e=>{const t={...e,id:`saved-${Date.now()}`,category:"my-prompts",isCustom:!0,dateAdded:(new Date).toISOString()},s=[...o,t];c(s),chrome.storage.local.set({savedPrompts:s})},u=async e=>{const t=o.filter(t=>t.id!==e.id);c(t),chrome.storage.local.set({savedPrompts:t})},p=(e=>{if(!t.trim())return e;const s=t.toLowerCase();return e.filter(e=>e.title.toLowerCase().includes(s)||e.prompt.toLowerCase().includes(s)||e.category.toLowerCase().includes(s))})("my-prompts"===e?o:r);return(0,a.jsxs)("div",{className:"prompt-list",children:[(0,a.jsxs)("div",{className:"prompt-list-header",children:[(0,a.jsx)("button",{className:"back-button",onClick:s,"aria-label":"Go back to categories",children:"â† Back"}),(0,a.jsx)("h2",{className:"category-title",children:t.trim()?`Search Results (${p.length})`:e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")})]}),l?(0,a.jsx)("div",{className:"loading-state",children:(0,a.jsx)("p",{children:"Loading prompts..."})}):0===p.length?(0,a.jsx)("div",{className:"empty-state",children:(0,a.jsx)("p",{children:t.trim()?`No prompts found for "${t}". Try different keywords.`:"my-prompts"===e?"No saved prompts yet. Browse categories and save your favorites!":"No prompts available for this category."})}):(0,a.jsx)("div",{className:"prompts-grid",children:p.map(t=>(0,a.jsx)(A,{prompt:t,onSave:"my-prompts"!==e?m:void 0,onRemove:"my-prompts"===e?u:void 0,isSaved:"my-prompts"===e,isCustomPrompt:"my-prompts"===e},t.id))})]})},F=({onUpgradeClick:e,showDetailsButton:t=!0})=>{const{userState:s,getRemainingModifications:r}=h(),[n,c]=(0,i.useState)(!0),l=r(),d=async()=>{if(e)e();else try{await o.openPaymentPage()}catch(e){console.error("Failed to open payment page:",e)}};return"free"===s.tier&&0===l&&n?(0,a.jsxs)("div",{className:"subscription-banner",children:[(0,a.jsx)("button",{className:"banner-close",onClick:()=>{c(!1)},"aria-label":"Close banner",children:"Ã—"}),(0,a.jsxs)("div",{className:"banner-content",children:[(0,a.jsx)("div",{className:"banner-icon",children:"âš¡"}),(0,a.jsxs)("div",{className:"banner-text",children:[(0,a.jsx)("h4",{children:"Out of free modifications"}),(0,a.jsx)("p",{children:"You've used all 3 daily modifications. Upgrade to continue."})]})]}),(0,a.jsxs)("div",{className:"banner-actions",children:[(0,a.jsx)("button",{className:"upgrade-button",onClick:d,children:"Upgrade Now"}),t&&(0,a.jsx)("button",{className:"details-button",onClick:d,children:"View Plans"})]})]}):null};r.createRoot(document.getElementById("root")).render((0,a.jsx)(i.StrictMode,{children:(0,a.jsx)(()=>{const[e,t]=(0,i.useState)({activeCategory:null,view:"browse"}),[s,r]=(0,i.useState)("");return(0,a.jsxs)("div",{className:"app",children:[(0,a.jsx)(v,{searchQuery:s,onSearch:s=>{r(s),s.trim()?t(e=>({...e,activeCategory:"all",view:"search"})):"search"===e.view&&t({activeCategory:null,view:"browse"})},onPromptCreated:()=>{r(""),t({activeCategory:"my-prompts",view:"my-prompts"})}}),(0,a.jsx)(F,{showDetailsButton:!1}),(0,a.jsx)("main",{className:"app-content",children:e.activeCategory?(0,a.jsx)(I,{category:e.activeCategory,searchQuery:s,onBack:()=>{t({activeCategory:null,view:"browse"}),r("")}}):(0,a.jsx)(j,{onCategorySelect:e=>{t(t=>({...t,activeCategory:e,view:"my-prompts"===e?"my-prompts":"browse"})),r("")}})})]})},{})}))}},s={};function a(e){var i=s[e];if(void 0!==i)return i.exports;var r=s[e]={exports:{}};return t[e].call(r.exports,r,r.exports,a),r.exports}a.m=t,e=[],a.O=(t,s,i,r)=>{if(!s){var n=1/0;for(d=0;d<e.length;d++){for(var[s,i,r]=e[d],o=!0,c=0;c<s.length;c++)(!1&r||n>=r)&&Object.keys(a.O).every(e=>a.O[e](s[c]))?s.splice(c--,1):(o=!1,r<n&&(n=r));if(o){e.splice(d--,1);var l=i();void 0!==l&&(t=l)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[s,i,r]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.e=()=>Promise.resolve(),a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={887:0};a.O.j=t=>0===e[t];var t=(t,s)=>{var i,r,[n,o,c]=s,l=0;if(n.some(t=>0!==e[t])){for(i in o)a.o(o,i)&&(a.m[i]=o[i]);if(c)var d=c(a)}for(t&&t(s);l<n.length;l++)r=n[l],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(d)},s=self.webpackChunkvprompter=self.webpackChunkvprompter||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var i=a.O(void 0,[121],()=>a(510));i=a.O(i)})();