(()=>{"use strict";var e,t={624:(e,t,s)=>{var a={};s.r(a);var i=s(848),o=s(540),r=s(338);const n=new class{constructor(){this.userState={isSignedIn:!1,tier:"anonymous",dailyModificationsUsed:0,lastResetDate:(new Date).toISOString().split("T")[0]},this.DAILY_FREE_MODIFICATIONS=3,this.listeners=new Set,this.loadUserState(),chrome.storage.onChanged.addListener((e,t)=>{"local"===t&&(e.user||e.apiKey)&&this.loadUserState()})}async loadUserState(){try{const e=await chrome.storage.local.get(["user","dailyUsage","subscription"]);if(e.user&&e.user.email&&(this.userState.isSignedIn=!0,this.userState.email=e.user.email,this.userState.userId=e.user.email,this.userState.tier="free"),e.dailyUsage){const t=(new Date).toISOString().split("T")[0];e.dailyUsage.date!==t?(this.userState.dailyModificationsUsed=0,this.userState.lastResetDate=t,await this.saveDailyUsage()):(this.userState.dailyModificationsUsed=e.dailyUsage.count||0,this.userState.lastResetDate=e.dailyUsage.date)}e.subscription&&"active"===e.subscription.status&&(this.userState.tier="paid",this.userState.subscription=e.subscription),this.notifyListeners()}catch(e){console.error("Failed to load user state:",e)}}async saveDailyUsage(){await chrome.storage.local.set({dailyUsage:{date:this.userState.lastResetDate,count:this.userState.dailyModificationsUsed}})}getUserState(){return{...this.userState}}getFeatureAccess(){const e=this.userState.tier,t=this.userState.dailyModificationsUsed<this.DAILY_FREE_MODIFICATIONS;switch(e){case"anonymous":default:return{viewPrompts:!0,copyPrompts:!0,savePrompts:!1,modifyPrompts:!1,createPrompts:!1,createSequences:!1,unlimitedUsage:!1};case"free":return{viewPrompts:!0,copyPrompts:!0,savePrompts:!0,modifyPrompts:t,createPrompts:t,createSequences:!0,unlimitedUsage:!1};case"paid":return{viewPrompts:!0,copyPrompts:!0,savePrompts:!0,modifyPrompts:!0,createPrompts:!0,createSequences:!0,unlimitedUsage:!0}}}canAccess(e){return this.getFeatureAccess()[e]}getUpgradeMessage(e){return this.userState.isSignedIn?{modifyPrompts:"Upgrade to Pro to increase your daily modification limit",createPrompts:"Upgrade to Pro to increase your daily creation limit",createSequences:"Upgrade to Pro to access advanced sequence features",unlimitedUsage:"Upgrade to Pro for unlimited usage"}[e]||"Upgrade to access this feature":"savePrompts"===e?"Sign up to save your favorite prompts":"Sign up for free to unlock this feature"}async signInWithGoogle(){return new Promise((e,t)=>{chrome.identity.getAuthToken({interactive:!0},async s=>{if(!chrome.runtime.lastError&&s)try{const t=await fetch("https://www.googleapis.com/oauth2/v1/userinfo",{headers:{Authorization:`Bearer ${s}`}});if(!t.ok)throw new Error("Failed to get user info");const a=await t.json();this.userState={isSignedIn:!0,tier:"free",email:a.email,userId:a.id,hasApiKey:this.userState.hasApiKey,dailyModificationsUsed:0,lastResetDate:(new Date).toISOString().split("T")[0]},await chrome.storage.local.set({userState:this.userState}),this.notifyListeners(),e()}catch(e){t(e)}else t(new Error(chrome.runtime.lastError?.message||"Sign in failed"))})})}async signOut(){chrome.identity.clearAllCachedAuthTokens(()=>{console.log("Signed out successfully")}),this.userState={isSignedIn:!1,tier:"anonymous",hasApiKey:!1,dailyModificationsUsed:0,lastResetDate:(new Date).toDateString()},await chrome.storage.local.remove(["userState"]),this.notifyListeners()}async upgradeToPaid(e){this.userState.tier="paid",this.userState.subscription={status:"active",plan:e.plan||"pro",expiresAt:e.expiresAt},await chrome.storage.local.set({subscription:this.userState.subscription}),this.notifyListeners()}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}notifyListeners(){const e=this.getUserState();this.listeners.forEach(t=>t(e))}async trackModification(){const e=(new Date).toISOString().split("T")[0];return this.userState.lastResetDate!==e&&(this.userState.dailyModificationsUsed=0,this.userState.lastResetDate=e),"paid"===this.userState.tier||!(this.userState.dailyModificationsUsed>=this.DAILY_FREE_MODIFICATIONS)&&(this.userState.dailyModificationsUsed++,await this.saveDailyUsage(),this.notifyListeners(),!0)}getRemainingModifications(){if("paid"===this.userState.tier)return-1;const e=(new Date).toISOString().split("T")[0];return this.userState.lastResetDate!==e?this.DAILY_FREE_MODIFICATIONS:Math.max(0,this.DAILY_FREE_MODIFICATIONS-this.userState.dailyModificationsUsed)}needsUpgrade(){return"free"===this.userState.tier&&this.userState.dailyModificationsUsed>=this.DAILY_FREE_MODIFICATIONS}};function c(){const[e,t]=(0,o.useState)(n.getUserState()),[s,a]=(0,o.useState)(n.getFeatureAccess()),[i,r]=(0,o.useState)(!1);return(0,o.useEffect)(()=>n.subscribe(e=>{t(e),a(n.getFeatureAccess())}),[]),{userState:e,featureAccess:s,isLoading:i,canAccess:e=>n.canAccess(e),getUpgradeMessage:e=>n.getUpgradeMessage(e),signIn:async()=>{r(!0);try{await n.signInWithGoogle()}catch(e){throw console.error("Sign in failed:",e),e}finally{r(!1)}},signOut:async()=>{r(!0);try{await n.signOut()}catch(e){throw console.error("Sign out failed:",e),e}finally{r(!1)}},trackModification:async()=>n.trackModification(),getRemainingModifications:()=>n.getRemainingModifications()}}const l=({onClose:e})=>{const{userState:t,getRemainingModifications:s,signOut:a}=c();return(0,i.jsx)("div",{className:"settings-overlay",role:"dialog","aria-modal":"true","aria-labelledby":"settings-title",children:(0,i.jsxs)("div",{className:"settings-modal",children:[(0,i.jsxs)("div",{className:"settings-header",children:[(0,i.jsx)("h2",{id:"settings-title",children:"Account & Settings"}),(0,i.jsx)("button",{className:"close-button",onClick:e,"aria-label":"Close settings",children:"âœ•"})]}),(0,i.jsxs)("div",{className:"settings-content",children:[(0,i.jsxs)("div",{className:"setting-group",children:[(0,i.jsx)("h3",{children:"Account Status"}),(0,i.jsxs)("div",{className:"account-info",children:[(0,i.jsxs)("div",{className:"status-item",children:[(0,i.jsx)("span",{className:"label",children:"Plan:"}),(0,i.jsx)("span",{className:`status-badge tier-${t.tier}`,children:"paid"===t.tier?"Pro":"free"===t.tier?"Free":"Anonymous"})]}),"free"===t.tier&&(0,i.jsxs)("div",{className:"status-item",children:[(0,i.jsx)("span",{className:"label",children:"Daily Modifications:"}),(0,i.jsxs)("span",{className:"usage-count",children:[s(),"/3 remaining"]})]}),t.isSignedIn&&(0,i.jsxs)("div",{className:"status-item",children:[(0,i.jsx)("span",{className:"label",children:"Status:"}),(0,i.jsx)("span",{className:"signed-in",children:"âœ“ Signed In"})]})]})]}),"paid"!==t.tier&&(0,i.jsxs)("div",{className:"setting-group upgrade-section",children:[(0,i.jsx)("h3",{children:"Upgrade to Pro"}),(0,i.jsxs)("div",{className:"upgrade-features",children:[(0,i.jsx)("div",{className:"feature",children:"âœ¨ Unlimited prompt modifications"}),(0,i.jsx)("div",{className:"feature",children:"ðŸŽ¯ Priority support"}),(0,i.jsx)("div",{className:"feature",children:"ðŸš€ Advanced features"})]}),(0,i.jsx)("button",{className:"upgrade-button",onClick:()=>{window.open("https://your-upgrade-url.com","_blank")},children:"Upgrade to Pro"})]}),(0,i.jsxs)("div",{className:"setting-group",children:[(0,i.jsx)("h3",{children:"About"}),(0,i.jsx)("p",{className:"about-text",children:"Veo 3 Prompt Assistant helps you create better prompts for Google's Veo 3 video AI model."}),(0,i.jsxs)("div",{className:"links",children:[(0,i.jsx)("a",{href:"https://github.com/your-repo",target:"_blank",rel:"noopener noreferrer",children:"GitHub"}),(0,i.jsx)("a",{href:"https://your-support-url.com",target:"_blank",rel:"noopener noreferrer",children:"Support"})]})]})]}),(0,i.jsxs)("div",{className:"settings-footer",children:[t.isSignedIn&&(0,i.jsx)("button",{className:"sign-out-button",onClick:async()=>{confirm("Are you sure you want to sign out?")&&(await a(),e())},children:"ðŸšª Sign Out"}),(0,i.jsx)("button",{className:"primary",onClick:e,children:"Close"})]})]})})},d=()=>{const[e,t]=(0,o.useState)(null),[s,a]=(0,o.useState)(!1),{}=c();(0,o.useEffect)(()=>{r()},[]);const r=async()=>{try{const e=await chrome.storage.local.get(["user"]);e.user&&t(e.user)}catch(e){console.error("Error checking auth status:",e)}};return s?(0,i.jsx)("div",{className:"google-auth",children:(0,i.jsx)("span",{className:"auth-loading",children:"Signing in..."})}):e?(0,i.jsxs)("div",{className:"google-auth signed-in",children:[e.picture&&(0,i.jsx)("img",{src:e.picture,alt:e.name||e.email,className:"user-avatar",referrerPolicy:"no-referrer"}),(0,i.jsxs)("div",{className:"user-info",children:[(0,i.jsx)("span",{className:"user-name",children:e.name||e.email}),(0,i.jsx)("button",{onClick:async()=>{try{chrome.identity.clearAllCachedAuthTokens(()=>{console.log("Signed out successfully")}),await chrome.storage.local.remove(["user"]),t(null)}catch(e){console.error("Sign out error:",e)}},className:"sign-out-btn",title:"Sign out",children:"Sign Out"})]})]}):(0,i.jsx)("div",{className:"google-auth",children:(0,i.jsxs)("button",{onClick:async()=>{a(!0);try{chrome.identity.getAuthToken({interactive:!0},async e=>{if(chrome.runtime.lastError||!e)return console.error("Sign in failed:",chrome.runtime.lastError),void a(!1);try{const s=await fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:`Bearer ${e}`}});if(s.ok){const e=await s.json(),a={email:e.email,name:e.name,picture:e.picture};await chrome.storage.local.set({user:a}),t(a)}}catch(e){console.error("Failed to get user info:",e)}a(!1)})}catch(e){console.error("Sign in error:",e),a(!1)}},className:"sign-in-btn",disabled:s,children:[(0,i.jsxs)("svg",{className:"google-icon",viewBox:"0 0 24 24",width:"18",height:"18",children:[(0,i.jsx)("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,i.jsx)("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,i.jsx)("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,i.jsx)("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Sign in"]})})};class m{constructor(){this.apiKey=null,this.knowledgeBase=null,this.secureStorage=null,"undefined"!=typeof SecureStorage&&(this.secureStorage=new SecureStorage)}static getInstance(){return m.instance||(m.instance=new m),m.instance}async loadKnowledgeBase(){if(this.knowledgeBase)return this.knowledgeBase;try{const e="undefined"!=typeof chrome&&chrome.runtime?chrome.runtime.getURL("data/knowledge-base.json"):"/data/knowledge-base.json",t=await fetch(e);return this.knowledgeBase=await t.json(),this.knowledgeBase}catch(e){return console.error("Failed to load knowledge base:",e),null}}generateSystemPrompt(e){return'You are an expert Veo 3 video prompt generator. Your task is to create detailed, effective prompts for Google\'s Veo 3 video generation model based on user descriptions or ideas.\n\nIMPORTANT: Always output your response as valid JSON with the following structure:\n{\n  "prompt": "the complete Veo 3 prompt",\n  "visual_elements": {\n    "subject": "description of who/what is in the scene",\n    "context": "where the scene takes place",\n    "action": "what is happening",\n    "style": "visual aesthetic (e.g., cinematic, animated, stop-motion)",\n    "camera_motion": "how the camera moves",\n    "composition": "how the shot is framed",\n    "ambiance": "mood and lighting"\n  },\n  "audio_elements": {\n    "dialogue": "what characters say (if any)",\n    "ambient_sound": "background noise",\n    "sound_effects": "specific sounds",\n    "music": "musical elements (if any)"\n  },\n  "technical_notes": {\n    "subtitles": "whether to include \'(no subtitles)\' directive",\n    "pronunciation_hints": "phonetic spellings if needed",\n    "character_consistency": "detailed character descriptions for consistency"\n  }\n}\n\nPROMPT CONSTRUCTION GUIDELINES:\n1. VISUAL ELEMENTS - Include all relevant details:\n   - Subject: Be specific about appearance, clothing, age, expressions\n   - Context: Describe the location in detail (indoor/outdoor, specific place)\n   - Action: Clear description of movement and behavior\n   - Style: Choose appropriate visual style (default is professional live-action)\n   - Camera motion: Use cinematography terms (dolly, zoom, pan, tracking, aerial, eye-level, etc.)\n   - Composition: Specify framing (wide shot, close-up, medium shot)\n   - Ambiance: Describe lighting, mood, color tones\n\n2. AUDIO ELEMENTS - Be explicit about all sounds:\n   - Dialogue: Use format "Character says: [exact words]" or describe what they talk about\n   - Keep dialogue under 8 seconds worth of speech\n   - Ambient sound: Specify background noise appropriate to the scene\n   - Sound effects: List any specific sounds needed\n   - Music: Describe genre, mood, and style if music is needed\n\n3. SPECIAL CONSIDERATIONS:\n   - For dialogue, use colon format: "Person says: words" (not quotes)\n   - Add "(no subtitles)" to prevent unwanted text overlays\n   - Use phonetic spelling for proper names or unusual pronunciations\n   - For selfie-style videos, start with "A selfie video of..." and mention visible arm\n   - For character consistency across scenes, repeat exact character descriptions\n   - Specify who speaks in multi-character scenes to avoid confusion\n\n4. PROMPT LENGTH:\n   - Create detailed prompts (100-200 words typically)\n   - More detail = better control over output\n   - Include negative instructions when needed (e.g., "no subtitles", "no laugh track")\n\n5. STYLE VARIATIONS:\n   - Default: Professional live-action video\n   - Available styles: animated, stop-motion, claymation, hand-drawn, watercolor, cinematic, documentary, found footage, etc.\n   - Style affects both visuals and character movement\n\nRemember:\n- Veo 3 produces consistent outputs for identical prompts\n- Change prompts significantly for variety\n- Be specific about what you want to avoid hallucinations\n- Layer multiple elements for rich, compelling videos'}async setApiKey(e){if(!e)return this.secureStorage?await this.secureStorage.removeApiKey():await chrome.storage.local.remove(["gptApiKey"]),void(this.apiKey=null);try{this.secureStorage?(await this.secureStorage.storeApiKey(e),this.apiKey=e):(this.apiKey=e,await chrome.storage.local.set({gptApiKey:e}))}catch(e){throw console.error("Failed to store API key:",e),e}}async getApiKey(){if(this.apiKey)return this.apiKey;try{if(this.secureStorage)return await this.secureStorage.migrateOldKey(),this.apiKey=await this.secureStorage.getApiKey(),this.apiKey;{const e=await chrome.storage.local.get(["gptApiKey"]);return this.apiKey=e.gptApiKey||null,this.apiKey}}catch(e){return console.error("Failed to retrieve API key:",e),this.apiKey=null,null}}async modifyPrompt(e){if(!e.instruction?.trim())throw new Error("ðŸ“ Modification instruction required: Please describe how you want to modify the prompt.");const t=await this.loadKnowledgeBase(),s=this.generateSystemPrompt(t);try{let t=await fetch("https://veo-prompt-assistant.netlify.app/.netlify/functions/gpt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"gpt-4o",systemPrompt:s,prompt:e.prompt,instruction:e.instruction,temperature:.7,maxTokens:800})});if(!t.ok)try{t=await fetch("http://localhost:8888/.netlify/functions/gpt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"gpt-4o",systemPrompt:s,prompt:e.prompt,instruction:e.instruction,temperature:.7,maxTokens:800})})}catch(e){}if(!t.ok){const e=await t.json().catch(()=>({})),s=e.error?.message;if(401===t.status)throw new Error("ðŸ” Unauthorized: Backend API key invalid or missing.");if(403===t.status)throw new Error("ðŸš« Access denied by backend.");if(429===t.status)throw new Error("â° Rate limit exceeded. Please try again later.");if(t.status>=500)throw new Error("ðŸ”§ Server error: Please try again shortly.");throw new Error(`âŒ Request error: ${s||"Please try again."}`)}const a=await t.json();if(!a?.content)throw new Error("ðŸ“­ Empty response: The AI didn't generate a response. Please try again with a different instruction.");try{const e=JSON.parse(a.content);if(e.prompt)return String(e.prompt).trim()}catch(e){}return String(a.content).trim()}catch(e){if(console.error("GPT API error:",e),e instanceof TypeError&&e.message.includes("fetch"))throw new Error("ðŸŒ Connection failed: Please check your internet connection and try again.");throw e}}}const p=({onClose:e,onSave:t})=>{const[s,a]=(0,o.useState)(""),[r,n]=(0,o.useState)(!1),[c,l]=(0,o.useState)(null),[d,p]=(0,o.useState)(null),[u,h]=(0,o.useState)(!1);return(0,i.jsx)("div",{className:"modal-backdrop",onClick:t=>{t.target===t.currentTarget&&e()},onKeyDown:t=>{"Escape"===t.key&&e()},children:(0,i.jsxs)("div",{className:"create-prompt-modal",role:"dialog","aria-labelledby":"create-prompt-title",children:[(0,i.jsxs)("div",{className:"modal-header",children:[(0,i.jsx)("h2",{id:"create-prompt-title",children:"âœ¨ Create New Prompt"}),(0,i.jsx)("button",{className:"close-button",onClick:e,"aria-label":"Close modal",children:"Ã—"})]}),(0,i.jsx)("div",{className:"modal-body",children:d?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Generated Prompt"}),(0,i.jsx)("textarea",{className:"description-input result-textarea",value:d,readOnly:!0,rows:12})]}),c&&(0,i.jsx)("div",{className:"error-message",children:c}),(0,i.jsxs)("div",{className:"modal-actions",children:[(0,i.jsxs)("div",{className:"button-group-left",children:[(0,i.jsx)("button",{className:"secondary",onClick:async()=>{if(d)try{await navigator.clipboard.writeText(d),l(null)}catch(e){l("Failed to copy. Please copy manually.")}},children:"ðŸ“‹ Copy"}),(0,i.jsx)("button",{className:"secondary",onClick:e,children:"Close"})]}),(0,i.jsx)("div",{className:"button-group-right",children:(0,i.jsx)("button",{className:"primary",onClick:()=>{if(!d)return;const e={id:`custom-${Date.now()}`,category:"my-prompts",title:s.length>50?s.substring(0,47)+"...":s,prompt:d,dateAdded:(new Date).toISOString(),isCustom:!0};t(e),h(!0)},disabled:u,children:u?"â­ Saved":"â­ Save to My Prompts"})})]})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"video-description",children:"Describe your video idea:"}),(0,i.jsx)("textarea",{id:"video-description",className:"description-input",value:s,onChange:e=>a(e.target.value),placeholder:"E.g., 'A tech reviewer unboxing the latest smartphone in a modern studio setup' or 'A cooking tutorial showing how to make homemade pasta'",rows:4,disabled:r})]}),c&&(0,i.jsx)("div",{className:"error-message",children:c}),(0,i.jsxs)("div",{className:"modal-actions",children:[(0,i.jsx)("div",{className:"button-group-left",children:(0,i.jsx)("button",{className:"secondary",onClick:e,disabled:r,children:"Cancel"})}),(0,i.jsx)("div",{className:"button-group-right",children:(0,i.jsx)("button",{className:"primary create-button",onClick:async()=>{if(s.trim()){n(!0),l(null);try{const e=m.getInstance(),t="You are an expert AI prompt engineer specializing in Google Veo 3. Transform ideas into prompts using the SSASAC framework:\n\n1) SUBJECT: Clearly identify who/what is the focus with specific details (e.g., 'grizzled detective in rumpled trench coat' not 'a man')\n2) SCENE: Describe environment in detail - where and when action occurs (e.g., 'dusty attic with afternoon light through grimy window')\n3) ACTION: Define what subject is doing with strong verbs, chain actions with 'this happens, then that happens'\n4) STYLE: Specify visual aesthetic (e.g., '1990s VHS footage', '8-bit video game', 'claymation', 'filmed on 16mm')\n5) AUDIO: Explicitly describe all sounds - dialogue, ambient sounds, SFX, and music (Veo 3's signature feature)\n6) CAMERA: Professional camera movements and shot specifications\n\nFor dialogue, use format: \"Character Name says (with emotional tone): 'Exact words.'\" - This prevents mixing up speakers.\n\nInclude negative prompt (no subtitles, no on-screen text) unless requested. Generate a professional Veo 3 prompt based on the user's description.",a=`Create a professional Veo 3 video prompt based on this idea: "${s}"\n\nFollow the JSON structure and include:\n- Detailed visual elements (subject, context, action, style, camera motion, composition, ambiance)\n- Complete audio elements (dialogue, ambient sound, sound effects, music)  \n- Technical considerations (subtitles directive, character consistency)\n\nCreate a detailed, cinematic prompt optimized for Veo 3.`,i=await e.modifyPrompt({prompt:t,instruction:a});p(i),h(!1)}catch(e){console.error("Error creating prompt:",e),l(e.message||"Failed to create prompt. Please try again.")}finally{n(!1)}}else l("Please describe your video idea")},disabled:r||!s.trim(),"aria-label":r?"Creating prompt":"Create prompt",children:r?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"loading-spinner"}),"Creating..."]}):(0,i.jsx)(i.Fragment,{children:"âœ¨ Create Prompt"})})})]})]})})]})})},u=({prompt:e,index:t,onRemove:s,onNextScene:a})=>{const[r,n]=(0,o.useState)(!1),[c,l]=(0,o.useState)(!1),[d,m]=(0,o.useState)(""),[p,u]=(0,o.useState)(!1);return(0,i.jsxs)("div",{className:"sequence-prompt-card",children:[(0,i.jsxs)("div",{className:"prompt-header",onClick:()=>n(!r),children:[(0,i.jsxs)("div",{className:"prompt-info",children:[(0,i.jsxs)("div",{className:"sequence-number",children:["#",t+1]}),(0,i.jsxs)("div",{className:"prompt-title-section",children:[(0,i.jsx)("h4",{children:e.title}),!r&&(0,i.jsxs)("p",{className:"prompt-preview",children:[e.prompt.substring(0,100),"..."]})]})]}),(0,i.jsx)("div",{className:"prompt-controls",children:(0,i.jsx)("span",{className:"expand-icon",children:r?"â–¼":"â–¶"})})]}),r&&(0,i.jsxs)("div",{className:"prompt-expanded",children:[(0,i.jsx)("p",{className:"prompt-full-text",children:e.prompt}),(0,i.jsxs)("div",{className:"prompt-actions",children:[(0,i.jsx)("button",{className:"action-btn copy-btn",onClick:async()=>{try{await navigator.clipboard.writeText(e.prompt)}catch(e){console.error("Failed to copy:",e)}},children:"ðŸ“‹ Copy"}),(0,i.jsx)("button",{className:"action-btn next-scene-btn",onClick:()=>l(!0),children:"ðŸŽ¬ Next Scene"}),(0,i.jsx)("button",{className:"action-btn remove-btn",onClick:s,children:"ðŸ—‘ï¸ Remove"})]})]}),c&&(0,i.jsx)("div",{className:"next-scene-modal",children:(0,i.jsxs)("div",{className:"modal-content",children:[(0,i.jsx)("h3",{children:"Create Next Scene"}),(0,i.jsx)("p",{children:"Describe what happens in the next scene. Characters and style will be preserved."}),(0,i.jsx)("textarea",{value:d,onChange:e=>m(e.target.value),placeholder:"e.g., The character walks into a coffee shop and orders a latte, then sits by the window watching the rain",rows:4}),(0,i.jsxs)("div",{className:"modal-actions",children:[(0,i.jsx)("button",{className:"cancel-btn",onClick:()=>l(!1),disabled:p,children:"Cancel"}),(0,i.jsx)("button",{className:"generate-btn",onClick:async()=>{if(d.trim()){u(!0);try{await a(e,d),l(!1),m("")}catch(e){console.error("Failed to generate next scene:",e)}finally{u(!1)}}},disabled:!d.trim()||p,children:p?"â³ Generating...":"âœ¨ Generate Scene"})]})]})})]})},h=({onClose:e})=>{const[t,s]=(0,o.useState)([]),[a,r]=(0,o.useState)(null),[n,c]=(0,o.useState)(!0),[l,d]=(0,o.useState)(!1),[h,g]=(0,o.useState)(""),[y,f]=(0,o.useState)(!1);(0,o.useEffect)(()=>{b()},[]);const b=async()=>{c(!0);try{const e=(await chrome.storage.local.get(["sequences"])).sequences||[];s(e)}catch(e){console.error("Failed to load sequences:",e)}c(!1)},v=async e=>{try{await chrome.storage.local.set({sequences:e}),s(e)}catch(e){console.error("Failed to save sequences:",e)}},x=async()=>{if(!h.trim())return;const e={id:`sequence-${Date.now()}`,name:h.trim(),prompts:[],createdAt:(new Date).toISOString()},s=[...t,e];await v(s),g(""),d(!1),r(e)},w=async e=>{if(!a)return;const s={...a,prompts:[...a.prompts,e]},i=t.map(e=>e.id===a.id?s:e);await v(i),r(s)},S=async(e,t)=>{if(!a)return;const s=m.getInstance(),i=`\n    Create the next scene in this sequence. \n    \n    IMPORTANT: Maintain character consistency:\n    - Keep the same character descriptions, clothing, and appearance\n    - Keep the same visual style and cinematography\n    - Keep the same mood and tone\n    \n    Previous scene: ${e.prompt}\n    \n    Next scene should: ${t}\n    \n    Generate a prompt that continues the story while maintaining all character and style elements from the previous scene.\n    `;try{const t=await s.modifyPrompt({prompt:e.prompt,instruction:i}),o={id:`scene-${Date.now()}`,category:e.category,title:`${e.title} - Scene ${a.prompts.length+1}`,prompt:t,dateAdded:(new Date).toISOString(),isCustom:!0};await w(o)}catch(e){throw console.error("Failed to generate next scene:",e),e}};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"modal-backdrop",onClick:t=>{t.target===t.currentTarget&&e()},onKeyDown:t=>{"Escape"===t.key&&e()},children:(0,i.jsxs)("div",{className:"sequences-modal",role:"dialog","aria-labelledby":"sequences-title",children:[(0,i.jsxs)("div",{className:"modal-header",children:[(0,i.jsx)("h2",{id:"sequences-title",children:"ðŸŽ¬ Sequences"}),(0,i.jsx)("button",{className:"close-button",onClick:e,"aria-label":"Close modal",children:"Ã—"})]}),(0,i.jsx)("div",{className:"modal-body",children:a?a?(0,i.jsxs)("div",{className:"sequence-details",children:[(0,i.jsxs)("div",{className:"sequence-header",children:[(0,i.jsx)("button",{className:"back-button",onClick:()=>r(null),children:"â† Back to Sequences"}),(0,i.jsx)("h3",{children:a.name})]}),(0,i.jsx)("div",{className:"sequence-actions",children:(0,i.jsx)("button",{className:"add-prompt-btn",onClick:()=>f(!0),children:"âœ¨ Add New Prompt"})}),(0,i.jsx)("div",{className:"sequence-prompts",children:0===a.prompts.length?(0,i.jsxs)("div",{className:"empty-sequence",children:[(0,i.jsx)("p",{children:"This sequence is empty."}),(0,i.jsx)("p",{children:'Click "Add New Prompt" to create a prompt for this sequence.'})]}):(0,i.jsx)("div",{className:"prompts-list",children:a.prompts.map((e,s)=>(0,i.jsx)(u,{prompt:e,index:s,onRemove:()=>(async e=>{if(!a)return;const s={...a,prompts:a.prompts.filter((t,s)=>s!==e)},i=t.map(e=>e.id===a.id?s:e);await v(i),r(s)})(s),onNextScene:S},s))})})]}):null:(0,i.jsxs)("div",{className:"sequences-list",children:[(0,i.jsxs)("div",{className:"sequences-header",children:[(0,i.jsx)("h3",{children:"Your Sequences"}),(0,i.jsx)("button",{className:"create-sequence-btn",onClick:()=>d(!0),children:"+ New Sequence"})]}),l&&(0,i.jsxs)("div",{className:"create-sequence-form",children:[(0,i.jsx)("input",{type:"text",placeholder:"Sequence name (e.g., 'Product Launch Campaign')",value:h,onChange:e=>g(e.target.value),onKeyDown:e=>"Enter"===e.key&&x(),autoFocus:!0}),(0,i.jsxs)("div",{className:"form-actions",children:[(0,i.jsx)("button",{onClick:()=>d(!1),children:"Cancel"}),(0,i.jsx)("button",{onClick:x,disabled:!h.trim(),children:"Create"})]})]}),n?(0,i.jsx)("div",{className:"loading",children:"Loading sequences..."}):0===t.length?(0,i.jsxs)("div",{className:"empty-state",children:[(0,i.jsx)("p",{children:"No sequences created yet."}),(0,i.jsx)("p",{children:"Create a sequence to organize multiple prompts for a video series or campaign."})]}):(0,i.jsx)("div",{className:"sequences-grid",children:t.map(e=>(0,i.jsxs)("div",{className:"sequence-card",onClick:()=>r(e),children:[(0,i.jsxs)("div",{className:"sequence-info",children:[(0,i.jsx)("h4",{children:e.name}),(0,i.jsxs)("p",{children:[e.prompts.length," prompts"]}),(0,i.jsxs)("span",{className:"sequence-date",children:["Created ",new Date(e.createdAt).toLocaleDateString()]})]}),(0,i.jsx)("button",{className:"delete-sequence-btn",onClick:s=>{s.stopPropagation(),(async e=>{if(!confirm("Are you sure you want to delete this sequence?"))return;const s=t.filter(t=>t.id!==e);await v(s),a?.id===e&&r(null)})(e.id)},title:"Delete sequence",children:"ðŸ—‘ï¸"})]},e.id))})]})})]})}),y&&(0,i.jsx)(p,{onClose:()=>f(!1),onSave:async e=>{await w(e),f(!1)}})]})},g=({isOpen:e,onClose:t,feature:s,message:a,userState:r,onSignIn:n,onUpgrade:c})=>{const[l,d]=(0,o.useState)(!1);if(!e)return null;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"modal-overlay",onClick:t}),(0,i.jsxs)("div",{className:"upgrade-modal",children:[(0,i.jsx)("button",{className:"modal-close",onClick:t,children:"Ã—"}),(0,i.jsxs)("div",{className:"modal-header",children:[(0,i.jsxs)("h2",{children:["Unlock ",s]}),(0,i.jsx)("p",{className:"modal-message",children:a})]}),(0,i.jsxs)("div",{className:"upgrade-options",children:[!r.isSignedIn&&(0,i.jsxs)("div",{className:"upgrade-option",children:[(0,i.jsx)("div",{className:"option-icon",children:"ðŸ‘¤"}),(0,i.jsx)("h3",{children:"Sign Up Free"}),(0,i.jsx)("p",{children:"Create a free account to save prompts and track your favorites"}),(0,i.jsxs)("ul",{className:"feature-list",children:[(0,i.jsx)("li",{children:"âœ“ Save unlimited prompts"}),(0,i.jsx)("li",{children:"âœ“ Organize your favorites"}),(0,i.jsx)("li",{children:"âœ“ 10 free AI generations"})]}),(0,i.jsx)("button",{className:"option-button primary",onClick:async()=>{if(n){d(!0);try{await n(),t()}catch(e){console.error("Sign in failed:",e)}finally{d(!1)}}},disabled:l,children:l?"Signing in...":"Sign Up with Google"})]}),r.isSignedIn&&(0,i.jsxs)("div",{className:"upgrade-option featured",children:[(0,i.jsx)("div",{className:"option-icon",children:"â­"}),(0,i.jsx)("h3",{children:"Upgrade to Pro"}),(0,i.jsx)("p",{children:"Unlock unlimited AI modifications and premium features"}),(0,i.jsxs)("ul",{className:"feature-list",children:[(0,i.jsx)("li",{children:"âœ“ Unlimited AI prompt modifications"}),(0,i.jsx)("li",{children:"âœ“ Create unlimited new prompts"}),(0,i.jsx)("li",{children:"âœ“ Priority support"}),(0,i.jsx)("li",{children:"âœ“ Advanced features"})]}),(0,i.jsx)("button",{className:"option-button premium",onClick:c,children:"Upgrade to Pro - $19/mo"}),(0,i.jsx)("span",{className:"option-note",children:"Best value for creators"})]})]}),r.isSignedIn&&"free"===r.tier&&(0,i.jsx)("div",{className:"usage-remaining",children:(0,i.jsxs)("span",{className:"usage-badge",children:[3-r.dailyModificationsUsed,"/3 free modifications today"]})})]})]})},y=({searchQuery:e="",onSearch:t,onPromptCreated:s})=>{const[a,r]=(0,o.useState)(!1),[n,m]=(0,o.useState)(!1),[u,y]=(0,o.useState)(!1),[f,b]=(0,o.useState)(!1),{userState:v,canAccess:x,getRemainingModifications:w}=c(),S=()=>{console.log("Upgrade clicked!"),b(!0)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("header",{className:"header",children:[(0,i.jsxs)("div",{className:"header-main",children:[(0,i.jsx)("div",{className:"header-left",children:(0,i.jsx)("img",{src:"/icons/icon32.svg",alt:"VeoPrompter Logo",className:"header-logo"})}),(0,i.jsxs)("div",{className:"header-right",children:[t&&(0,i.jsxs)("div",{className:"search-container",children:[(0,i.jsx)("input",{type:"text",className:"search-input",placeholder:"Search...",value:e,onChange:e=>t(e.target.value),"aria-label":"Search prompts"}),(0,i.jsx)("span",{className:"search-icon","aria-hidden":"true",children:"ðŸ”"})]}),(0,i.jsx)("div",{className:"user-status-compact",children:v.isSignedIn?(0,i.jsxs)("div",{className:"user-info-compact",children:[(0,i.jsx)("button",{className:`user-tier-badge-compact tier-${v.tier} ${"free"===v.tier?"clickable":""}`,onClick:"free"===v.tier?S:void 0,disabled:"paid"===v.tier,title:"free"===v.tier?"Click to upgrade to Pro":"Pro plan",children:"paid"===v.tier?"â­":"ðŸŽ"}),"free"===v.tier&&(0,i.jsxs)("button",{className:`modifications-count-compact ${0===w()?"limit-reached":""} clickable`,onClick:S,title:"Click to upgrade for unlimited modifications",children:[w(),"/3"]})]}):(0,i.jsx)(d,{})}),(0,i.jsx)("button",{className:"icon-button",onClick:()=>{r(!0)},"aria-label":"Open settings",children:"âš™ï¸"})]})]}),(x("createPrompts")||x("createSequences"))&&(0,i.jsxs)("div",{className:"header-actions-compact",children:[x("createPrompts")&&(0,i.jsx)("button",{className:"action-button-compact create-prompt-btn",onClick:()=>m(!0),title:"Create new prompt with AI",children:"âœ¨ Create New Prompt"}),x("createSequences")&&(0,i.jsx)("button",{className:"action-button-compact sequences-btn",onClick:()=>y(!0),title:"Manage sequences",children:"ðŸŽ¬ Sequences"})]})]}),a&&(0,i.jsx)(l,{onClose:()=>{r(!1)}}),n&&(0,i.jsx)(p,{onClose:()=>m(!1),onSave:async e=>{const t=[...(await chrome.storage.local.get(["savedPrompts"])).savedPrompts||[],e];await chrome.storage.local.set({savedPrompts:t}),s&&s(e)}}),u&&(0,i.jsx)(h,{onClose:()=>y(!1)}),f&&(0,i.jsx)(g,{isOpen:f,onClose:()=>b(!1),feature:"Pro Features",message:"Upgrade to Pro for unlimited modifications and advanced features",userState:v,onUpgrade:()=>{window.open("https://your-upgrade-url.com","_blank"),b(!1)}})]})},f=[{id:"1",name:"my-prompts",icon:"â­",description:"Your saved and custom prompts",color:"#FECA57"},{id:"2",name:"ads",icon:"ðŸ“º",description:"Commercial and advertising prompts",color:"#FF6B6B"},{id:"3",name:"storytelling",icon:"ðŸ“–",description:"Narrative and story-driven content",color:"#4ECDC4"},{id:"4",name:"tutorial",icon:"ðŸŽ“",description:"Educational and how-to content",color:"#45B7D1"},{id:"5",name:"vlogging",icon:"ðŸ“¹",description:"Personal vlog and lifestyle content",color:"#96CEB4"},{id:"6",name:"mobile-game",icon:"ðŸŽ®",description:"Mobile game ads and gameplay",color:"#A8E6CF"},{id:"7",name:"street-interview",icon:"ðŸŽ¤",description:"Street interviews and social content",color:"#FF8B94"},{id:"8",name:"tech-influencer",icon:"ðŸ’»",description:"Tech reviews and influencer content",color:"#B4A7D6"}],b=({onCategorySelect:e})=>(0,i.jsx)("main",{className:"category-grid",role:"main","aria-label":"Prompt categories",children:f.map(t=>{const s=t.name.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");return(0,i.jsxs)("div",{className:"category-card",onClick:()=>e(t.name),onKeyDown:s=>((t,s)=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),e(s))})(s,t.name),style:{borderColor:t.color},role:"button",tabIndex:0,"aria-label":`${s} category. ${t.description}`,children:[(0,i.jsx)("div",{className:"category-icon",style:{backgroundColor:t.color+"20"},"aria-hidden":"true",children:t.icon}),(0,i.jsx)("h3",{className:"category-name",children:s}),(0,i.jsx)("p",{className:"category-description",children:t.description}),(0,i.jsx)("span",{className:"category-count","aria-label":"Click to view prompts in this category",children:"View prompts"})]},t.id)})});var v=s(223),x=s(26);const w={apiKey:"AIzaSyCDsAJx-JUCuKC1-YR16N7APYpTh--SSLo",authDomain:"videoprompter-d6a18.firebaseapp.com",projectId:"videoprompter-d6a18",storageBucket:"videoprompter-d6a18.firebasestorage.app",messagingSenderId:"43646976330",appId:"1:43646976330:web:6d57b38a3f6c98d4c2c1b3"};new class{constructor(){this.db=null,this.prompts=[],this.categories=[],this.unsubscribe=null,this.initialized=!1}async initialize(){if(!this.initialized)try{const e=(0,v.Dk)(),t=0===e.length?(0,v.Wp)(w):e[0];this.db=(0,x.aU)(t),this.initialized=!0;try{await(0,x.enablePersistentCaching)(this.db)}catch(e){console.warn("Firebase persistence failed:",e)}return!0}catch(e){return console.error("Firebase initialization failed:",e),!1}}subscribeToPrompts(e){if(!this.db)return void console.error("Firebase not initialized");const t=(0,x.rJ)(this.db,"prompts"),s=(0,x.P)(t,(0,x.My)("category"),(0,x.My)("order","asc"));this.unsubscribe=(0,x.aQ)(s,t=>{const s=[];t.forEach(e=>{s.push({id:e.id,...e.data()})}),this.prompts=s,e(s),chrome.storage.local.set({cachedPrompts:s,lastSync:Date.now()})},t=>{console.error("Firebase subscription error:",t),this.loadCachedPrompts(e)})}async loadCachedPrompts(e){const t=await chrome.storage.local.get(["cachedPrompts"]);t.cachedPrompts&&(this.prompts=t.cachedPrompts,e(t.cachedPrompts))}async getCategories(){if(!this.db)return[];try{const e=(0,x.rJ)(this.db,"categories"),t=(0,x.P)(e,(0,x.My)("order")),s=await(0,x.GG)(t),a=[];return s.forEach(e=>{a.push({id:e.id,...e.data()})}),a}catch(e){return console.error("Failed to load categories:",e),[{id:"ads",name:"Ads",icon:"ðŸ“º",description:"Commercial & promotional content"},{id:"storytelling",name:"Storytelling",icon:"ðŸ“–",description:"Narrative & cinematic content"},{id:"tutorial",name:"Tutorial",icon:"ðŸŽ“",description:"Educational & how-to content"},{id:"vlogging",name:"Vlogging",icon:"ðŸŽ¥",description:"Personal & lifestyle content"},{id:"street-interview",name:"Street Interview",icon:"ðŸŽ¤",description:"Urban documentary style"},{id:"tech-influencer",name:"Tech Influencer",icon:"ðŸ’»",description:"Tech reviews & announcements"},{id:"mobile-game",name:"Mobile Game",icon:"ðŸŽ®",description:"Game advertisements"}]}}unsubscribeFromPrompts(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}async isFirebaseEnabled(){return"YOUR_API_KEY"!==w.apiKey&&"YOUR_PROJECT_ID"!==w.projectId}};const S=new class{constructor(){this.prompts=[],this.loaded=!1,this.unsubscribe=null}async initialize(){console.log("ðŸ”„ Starting prompt data initialization...");try{console.log("ðŸ“Š Trying admin dashboard first...");const e=await this.loadFromAdminDashboard();if(e.length>0)return console.log(`âœ… Loaded ${e.length} prompts from admin dashboard`),this.prompts=e,this.loaded=!0,e}catch(e){console.warn("âŒ Admin dashboard failed:",e)}try{console.log("ðŸ“‹ Falling back to prompts.txt...");const e=await this.loadFromPromptsFile();return console.log(`âœ… Loaded ${e.length} prompts from prompts.txt`),this.prompts=e,this.loaded=!0,e}catch(e){console.error("âŒ All data sources failed:",e);const t=this.getDefaultPrompts();return this.prompts=t,this.loaded=!0,t}}async loadFromFirebase(){try{return await a.default.initialize(),new Promise(e=>{a.default.subscribeToPrompts(t=>{this.prompts=t.map((e,t)=>({id:e.id||`firebase-${t+1}`,category:e.category,title:e.title,prompt:e.prompt,youtubeLink:e.youtubeLink,dateAdded:e.dateAdded||(new Date).toISOString(),isCustom:!1})),this.loaded=!0,console.log(`Loaded ${this.prompts.length} prompts from Firebase`),e(this.prompts)})})}catch(e){return console.warn("Failed to load from Firebase:",e),[]}}async loadFromAdminDashboard(){const e=await fetch("/admin-dashboard/prompts-data.json");if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);const t=await e.json();if(console.log("Fetched admin dashboard JSON data"),t&&t.prompts&&Array.isArray(t.prompts)){const e=t.prompts;console.log(`Converting ${e.length} admin prompts to internal format`);const s=e.map((e,t)=>({id:`admin-${t+1}`,category:e.category,title:e.title,prompt:e.prompt,youtubeLink:e.youtubeLink,dateAdded:(new Date).toISOString(),isCustom:!1}));return console.log(`âœ… Successfully converted ${s.length} prompts`),s}throw new Error("Invalid JSON structure - prompts not found or not array")}async loadFromPromptsFile(){const e=await fetch("/data/prompts.txt");if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);const t=(await e.text()).split("\n").filter(e=>e.trim()&&!e.startsWith("#")).map((e,t)=>{const[s,a,i,o]=e.split("|").map(e=>e.trim());return{id:`prompt-${t+1}`,category:s,title:a,prompt:i,youtubeLink:o||void 0,dateAdded:(new Date).toISOString(),isCustom:!1}}).filter(e=>e.title&&e.prompt);return console.log(`âœ… Successfully parsed ${t.length} prompts from prompts.txt`),t}async getPrompts(){return this.loaded||await this.initialize(),this.prompts}async getPromptsByCategory(e){const t=await this.getPrompts();return"all"===e?t:"my-prompts"===e?(await chrome.storage.local.get(["savedPrompts"])).savedPrompts||[]:t.filter(t=>t.category===e)}async searchPrompts(e){const t=await this.getPrompts(),s=e.toLowerCase();return t.filter(e=>e.title.toLowerCase().includes(s)||e.prompt.toLowerCase().includes(s)||e.category.toLowerCase().includes(s))}getDefaultPrompts(){return[{id:"default-1",category:"ads",title:"Product Launch Teaser",prompt:"Create a 30-second teaser video for a new tech product launch.",dateAdded:(new Date).toISOString(),isCustom:!1},{id:"default-2",category:"storytelling",title:"Mystery Opening",prompt:"Create an opening scene for a mystery short film.",dateAdded:(new Date).toISOString(),isCustom:!1},{id:"default-3",category:"tutorial",title:"Cooking Tutorial",prompt:"Film a cooking tutorial with overhead shots.",dateAdded:(new Date).toISOString(),isCustom:!1},{id:"default-4",category:"vlogging",title:"Day in My Life",prompt:'Film a "day in my life" vlog.',dateAdded:(new Date).toISOString(),isCustom:!1}]}async reload(){return this.loaded=!1,this.prompts=[],this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null),this.initialize()}cleanup(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null),a.default.unsubscribeFromPrompts()}},j=({message:e})=>(0,i.jsx)("div",{className:"toast",role:"status","aria-live":"polite","aria-atomic":"true",children:e}),N=({prompt:e,onSave:t,onRemove:s,isSaved:a})=>{const[r,n]=(0,o.useState)(!1),[l,d]=(0,o.useState)(!1),[p,u]=(0,o.useState)(""),[h,y]=(0,o.useState)(!1),[f,b]=(0,o.useState)(""),[v,x]=(0,o.useState)(e.prompt),[w,S]=(0,o.useState)(!1),[N,C]=(0,o.useState)(!1),[P,k]=(0,o.useState)(""),[A,I]=(0,o.useState)(""),[D,F]=(0,o.useState)(!1),[E,O]=(0,o.useState)([]),{userState:U,canAccess:T,getUpgradeMessage:q,signIn:M,trackModification:L,getRemainingModifications:R}=c(),K=e=>{u(e),d(!0),setTimeout(()=>d(!1),3e3)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"prompt-card",children:[(0,i.jsxs)("div",{className:"prompt-header",onClick:()=>n(!r),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),n(!r))},role:"button",tabIndex:0,"aria-expanded":r,"aria-controls":`prompt-content-${e.id}`,"aria-label":`${r?"Collapse":"Expand"} prompt: ${e.title}`,children:[(0,i.jsx)("h3",{className:"prompt-title",children:e.title}),(0,i.jsx)("span",{className:"expand-icon","aria-hidden":"true",children:r?"â–¼":"â–¶"})]}),r&&(0,i.jsxs)("div",{className:"prompt-content",id:`prompt-content-${e.id}`,role:"region","aria-label":"Prompt details",children:[(0,i.jsx)("p",{className:"prompt-text",children:v}),h?(0,i.jsxs)("div",{className:"modify-section",children:[(0,i.jsx)("textarea",{className:"modify-input",placeholder:"How would you like to modify this prompt? (e.g., 'make it more dramatic', 'add slow motion effects')",value:f,onChange:e=>b(e.target.value)}),(0,i.jsxs)("div",{className:"modify-actions",children:[(0,i.jsx)("button",{className:"secondary",onClick:()=>y(!1),disabled:w,children:"Cancel"}),(0,i.jsx)("button",{className:"primary",onClick:async()=>{if(f.trim()){if("free"===U.tier&&!await L())return k("Daily Limit Reached"),I("You've used all 3 free modifications today. Upgrade for unlimited access!"),void C(!0);S(!0);try{const e=m.getInstance(),t=await e.modifyPrompt({prompt:v,instruction:f});x(t),y(!1),b("");const s=R();"free"===U.tier&&s>0?K(`âœ¨ Prompt modified! ${s} free modifications left today.`):"free"===U.tier&&0===s?K("âœ¨ Prompt modified! That was your last free modification for today."):K("âœ¨ Prompt modified successfully!")}catch(e){console.error("Failed to modify prompt:",e);const t=e instanceof Error?e.message:"âŒ Failed to modify prompt";K(t)}finally{S(!1)}}else K("ðŸ“ Please enter a modification instruction")},disabled:w||!f.trim(),"aria-label":w?"Modifying prompt, please wait":"Apply modification to prompt",children:w?"â³ Modifying...":"âœ¨ Apply"})]})]}):(0,i.jsxs)("div",{className:"prompt-actions",role:"group","aria-label":"Prompt actions",children:[(0,i.jsx)("button",{className:"action-button",onClick:async()=>{try{await navigator.clipboard.writeText(v),K("ðŸ“‹ Prompt copied to clipboard!")}catch(e){try{const e=document.createElement("textarea");e.value=v,e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.select();const t=document.execCommand("copy");if(document.body.removeChild(e),!t)throw new Error("Copy command failed");K("ðŸ“‹ Prompt copied to clipboard!")}catch(e){console.error("Copy failed:",e),K("âŒ Failed to copy: Please select and copy the text manually")}}},"aria-label":"Copy prompt to clipboard",children:"ðŸ“‹ Copy"}),(0,i.jsx)("button",{className:"action-button "+(T("createSequences")?"":"locked"),onClick:async()=>{if(!T("createSequences"))return k("Sequences"),I(q("createSequences")),void C(!0);const e=(await chrome.storage.local.get(["sequences"])).sequences||[];0!==e.length?(O(e),F(!0)):K("ðŸ“ Create a sequence first in the Sequences menu")},"aria-label":"Add to sequence",children:"ðŸŽ¬ Add to Sequence"}),(0,i.jsxs)("button",{className:"action-button "+(T("modifyPrompts")?"":"locked"),onClick:()=>{if(!T("modifyPrompts"))return k("AI Prompt Modification"),I(q("modifyPrompts")),void C(!0);y(!0)},"aria-label":T("modifyPrompts")?"Modify this prompt using AI":"Modify prompt (requires API key or subscription)",children:["âœï¸ Modify ",!T("modifyPrompts")&&"ðŸ”’"]}),(0,i.jsx)("button",{className:"action-button",onClick:()=>{e.youtubeLink?window.open(e.youtubeLink,"_blank"):K("ðŸŽ¬ Preview coming soon!")},"aria-label":"Preview example video",children:"â–¶ï¸ Preview"}),t&&!a&&(0,i.jsx)("button",{className:"action-button",onClick:async()=>{if(t){if(!T("savePrompts"))return k("Save Prompts"),I(q("savePrompts")),void C(!0);t(e),K("â­ Prompt saved successfully!")}},"aria-label":"Save prompt to favorites",children:"â­ Save"}),s&&(0,i.jsx)("button",{className:"action-button remove-prompt-btn",onClick:()=>{s&&confirm("Are you sure you want to remove this prompt from your collection?")&&(s(e),K("ðŸ—‘ï¸ Prompt removed from My Prompts"))},"aria-label":"Remove prompt from My Prompts",children:"ðŸ—‘ï¸ Remove"})]})]})]}),l&&(0,i.jsx)(j,{message:p}),(0,i.jsx)(g,{isOpen:N,onClose:()=>C(!1),feature:P,message:A,userState:U,onSignIn:M,onAddApiKey:()=>{K("API key management coming soon!")},onUpgrade:()=>{K("Upgrade flow coming soon!")}}),D&&(0,i.jsx)("div",{className:"sequence-selector-modal",children:(0,i.jsxs)("div",{className:"modal-content",children:[(0,i.jsx)("h3",{children:"Select Sequence"}),(0,i.jsx)("p",{children:"Choose which sequence to add this prompt to:"}),(0,i.jsx)("div",{className:"sequences-list",children:E.map(t=>(0,i.jsx)("button",{className:"sequence-option",onClick:()=>(async t=>{t.prompts.push(e);const s=((await chrome.storage.local.get(["sequences"])).sequences||[]).map(e=>e.id===t.id?t:e);await chrome.storage.local.set({sequences:s}),K(`ðŸŽ¬ Added to "${t.name}"`),F(!1)})(t),children:(0,i.jsxs)("div",{className:"sequence-info",children:[(0,i.jsx)("strong",{children:t.name}),(0,i.jsxs)("span",{children:[t.prompts.length," prompts"]})]})},t.id))}),(0,i.jsx)("button",{className:"cancel-sequence-btn",onClick:()=>F(!1),children:"Cancel"})]})})]})},C=({category:e,searchQuery:t="",onBack:s})=>{const[a,r]=(0,o.useState)([]),[n,c]=(0,o.useState)([]),[l,d]=(0,o.useState)(!0);(0,o.useEffect)(()=>{(async()=>{d(!0);try{if("my-prompts"===e){const e=await chrome.storage.local.get(["savedPrompts"]);c(e.savedPrompts||[])}else if("all"===e){const e=await S.getPrompts();r(e)}else{const t=await S.getPromptsByCategory(e);r(t)}}catch(e){console.error("Failed to load prompts:",e)}d(!1)})()},[e]);const m=async e=>{const t={...e,id:`saved-${Date.now()}`,category:"my-prompts",isCustom:!0,dateAdded:(new Date).toISOString()},s=[...n,t];c(s),chrome.storage.local.set({savedPrompts:s})},p=async e=>{const t=n.filter(t=>t.id!==e.id);c(t),chrome.storage.local.set({savedPrompts:t})},u=(e=>{if(!t.trim())return e;const s=t.toLowerCase();return e.filter(e=>e.title.toLowerCase().includes(s)||e.prompt.toLowerCase().includes(s)||e.category.toLowerCase().includes(s))})("my-prompts"===e?n:a);return(0,i.jsxs)("div",{className:"prompt-list",children:[(0,i.jsxs)("div",{className:"prompt-list-header",children:[(0,i.jsx)("button",{className:"back-button",onClick:s,"aria-label":"Go back to categories",children:"â† Back"}),(0,i.jsx)("h2",{className:"category-title",children:t.trim()?`Search Results (${u.length})`:e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")})]}),l?(0,i.jsx)("div",{className:"loading-state",children:(0,i.jsx)("p",{children:"Loading prompts..."})}):0===u.length?(0,i.jsx)("div",{className:"empty-state",children:(0,i.jsx)("p",{children:t.trim()?`No prompts found for "${t}". Try different keywords.`:"my-prompts"===e?"No saved prompts yet. Browse categories and save your favorites!":"No prompts available for this category."})}):(0,i.jsx)("div",{className:"prompts-grid",children:u.map(t=>(0,i.jsx)(N,{prompt:t,onSave:"my-prompts"!==e?m:void 0,onRemove:"my-prompts"===e?p:void 0,isSaved:"my-prompts"===e},t.id))})]})},P=({onUpgradeClick:e,showDetailsButton:t=!0})=>{const{userState:s,getRemainingModifications:a}=c(),[r,n]=(0,o.useState)(!0),l=a(),d=()=>{e?e():window.open("https://your-upgrade-url.com","_blank")};return"free"===s.tier&&0===l&&r?(0,i.jsxs)("div",{className:"subscription-banner",children:[(0,i.jsx)("button",{className:"banner-close",onClick:()=>{n(!1)},"aria-label":"Close banner",children:"Ã—"}),(0,i.jsxs)("div",{className:"banner-content",children:[(0,i.jsx)("div",{className:"banner-icon",children:"âš¡"}),(0,i.jsxs)("div",{className:"banner-text",children:[(0,i.jsx)("h4",{children:"Out of free modifications"}),(0,i.jsx)("p",{children:"You've used all 3 daily modifications. Upgrade to continue."})]})]}),(0,i.jsxs)("div",{className:"banner-actions",children:[(0,i.jsx)("button",{className:"upgrade-button",onClick:d,children:"Upgrade Now"}),t&&(0,i.jsx)("button",{className:"details-button",onClick:d,children:"View Plans"})]})]}):null};r.createRoot(document.getElementById("root")).render((0,i.jsx)(o.StrictMode,{children:(0,i.jsx)(()=>{const[e,t]=(0,o.useState)({activeCategory:null,view:"browse"}),[s,a]=(0,o.useState)("");return(0,i.jsxs)("div",{className:"app",children:[(0,i.jsx)(y,{searchQuery:s,onSearch:s=>{a(s),s.trim()?t(e=>({...e,activeCategory:"all",view:"search"})):"search"===e.view&&t({activeCategory:null,view:"browse"})},onPromptCreated:()=>{a(""),t({activeCategory:"my-prompts",view:"my-prompts"})}}),(0,i.jsx)(P,{showDetailsButton:!1}),(0,i.jsx)("main",{className:"app-content",children:e.activeCategory?(0,i.jsx)(C,{category:e.activeCategory,searchQuery:s,onBack:()=>{t({activeCategory:null,view:"browse"}),a("")}}):(0,i.jsx)(b,{onCategorySelect:e=>{t(t=>({...t,activeCategory:e,view:"my-prompts"===e?"my-prompts":"browse"})),a("")}})})]})},{})}))}},s={};function a(e){var i=s[e];if(void 0!==i)return i.exports;var o=s[e]={exports:{}};return t[e].call(o.exports,o,o.exports,a),o.exports}a.m=t,e=[],a.O=(t,s,i,o)=>{if(!s){var r=1/0;for(d=0;d<e.length;d++){for(var[s,i,o]=e[d],n=!0,c=0;c<s.length;c++)(!1&o||r>=o)&&Object.keys(a.O).every(e=>a.O[e](s[c]))?s.splice(c--,1):(n=!1,o<r&&(r=o));if(n){e.splice(d--,1);var l=i();void 0!==l&&(t=l)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[s,i,o]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.j=887,(()=>{var e={887:0};a.O.j=t=>0===e[t];var t=(t,s)=>{var i,o,[r,n,c]=s,l=0;if(r.some(t=>0!==e[t])){for(i in n)a.o(n,i)&&(a.m[i]=n[i]);if(c)var d=c(a)}for(t&&t(s);l<r.length;l++)o=r[l],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(d)},s=self.webpackChunkveo_3_prompt_assistant=self.webpackChunkveo_3_prompt_assistant||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var i=a.O(void 0,[121],()=>a(624));i=a.O(i)})();